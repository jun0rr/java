(function(){var y=this,c=y._,j={},T=Array.prototype,e=Object.prototype,X=T.slice,P=T.unshift,l=e.toString,q=e.hasOwnProperty,r=T.forEach,ab=T.map,aa=T.reduce,R=T.reduceRight,I=T.filter,L=T.every,i=T.some,g=T.indexOf,ad=T.lastIndexOf;e=Array.isArray;var d=Object.keys,ac=function(f){return new K(f)};if(typeof module!=="undefined"&&module.exports){module.exports=ac;ac._=ac}else{y._=ac}ac.VERSION="1.1.4";var o=ac.each=ac.forEach=function(f,k,n){if(f!=null){if(r&&f.forEach===r){f.forEach(k,n)}else{if(ac.isNumber(f.length)){for(var m=0,h=f.length;m<h;m++){if(k.call(n,f[m],m,f)===j){break}}}else{for(m in f){if(q.call(f,m)){if(k.call(n,f[m],m,f)===j){break}}}}}}};ac.map=function(f,h,m){var k=[];if(f==null){return k}if(ab&&f.map===ab){return f.map(h,m)}o(f,function(u,n,s){k[k.length]=h.call(m,u,n,s)});return k};ac.reduce=ac.foldl=ac.inject=function(f,k,n,m){var h=n!==void 0;if(f==null){f=[]}if(aa&&f.reduce===aa){if(m){k=ac.bind(k,m)}return h?f.reduce(k,n):f.reduce(k)}o(f,function(s,v,u){if(!h&&v===0){n=s;h=true}else{n=k.call(m,n,s,v,u)}});if(!h){throw new TypeError("Reduce of empty array with no initial value")}return n};ac.reduceRight=ac.foldr=function(f,h,m,k){if(f==null){f=[]}if(R&&f.reduceRight===R){if(k){h=ac.bind(h,k)}return m!==void 0?f.reduceRight(h,m):f.reduceRight(h)}f=(ac.isArray(f)?f.slice():ac.toArray(f)).reverse();return ac.reduce(f,h,m,k)};ac.find=ac.detect=function(f,h,m){var k;p(f,function(u,n,s){if(h.call(m,u,n,s)){k=u;return true}});return k};ac.filter=ac.select=function(f,h,m){var k=[];if(f==null){return k}if(I&&f.filter===I){return f.filter(h,m)}o(f,function(u,n,s){if(h.call(m,u,n,s)){k[k.length]=u}});return k};ac.reject=function(f,h,m){var k=[];if(f==null){return k}o(f,function(u,n,s){h.call(m,u,n,s)||(k[k.length]=u)});return k};ac.every=ac.all=function(f,h,m){h=h||ac.identity;var k=true;if(f==null){return k}if(L&&f.every===L){return f.every(h,m)}o(f,function(u,n,s){if(!(k=k&&h.call(m,u,n,s))){return j}});return k};var p=ac.some=ac.any=function(f,h,m){h=h||ac.identity;var k=false;if(f==null){return k}if(i&&f.some===i){return f.some(h,m)}o(f,function(u,n,s){if(k=h.call(m,u,n,s)){return j}});return k};ac.include=ac.contains=function(f,h){var k=false;if(f==null){return k}if(g&&f.indexOf===g){return f.indexOf(h)!=-1}p(f,function(m){if(k=m===h){return true}});return k};ac.invoke=function(f,h){var k=X.call(arguments,2);return ac.map(f,function(m){return(h?m[h]:m).apply(m,k)})};ac.pluck=function(f,h){return ac.map(f,function(k){return k[h]})};ac.max=function(f,h,m){if(!h&&ac.isArray(f)){return Math.max.apply(Math,f)}var k={computed:-Infinity};o(f,function(u,n,s){n=h?h.call(m,u,n,s):u;n>=k.computed&&(k={value:u,computed:n})});return k.value};ac.min=function(f,h,m){if(!h&&ac.isArray(f)){return Math.min.apply(Math,f)}var k={computed:Infinity};o(f,function(u,n,s){n=h?h.call(m,u,n,s):u;n<k.computed&&(k={value:u,computed:n})});return k.value};ac.sortBy=function(f,h,k){return ac.pluck(ac.map(f,function(s,n,m){return{value:s,criteria:h.call(k,s,n,m)}}).sort(function(u,s){var m=u.criteria,n=s.criteria;return m<n?-1:m>n?1:0}),"value")};ac.sortedIndex=function(f,m,s){s=s||ac.identity;for(var n=0,k=f.length;n<k;){var h=n+k>>1;s(f[h])<s(m)?n=h+1:k=h}return n};ac.toArray=function(f){if(!f){return[]}if(f.toArray){return f.toArray()}if(ac.isArray(f)){return f}if(ac.isArguments(f)){return X.call(f)}return ac.values(f)};ac.size=function(f){return ac.toArray(f).length};ac.first=ac.head=function(f,h,k){return h&&!k?X.call(f,0,h):f[0]};ac.rest=ac.tail=function(f,h,k){return X.call(f,ac.isUndefined(h)||k?1:h)};ac.last=function(f){return f[f.length-1]};ac.compact=function(f){return ac.filter(f,function(h){return !!h})};ac.flatten=function(f){return ac.reduce(f,function(h,k){if(ac.isArray(k)){return h.concat(ac.flatten(k))}h[h.length]=k;return h},[])};ac.without=function(f){var h=X.call(arguments,1);return ac.filter(f,function(k){return !ac.include(h,k)})};ac.uniq=ac.unique=function(f,h){return ac.reduce(f,function(n,m,k){if(0==k||(h===true?ac.last(n)!=m:!ac.include(n,m))){n[n.length]=m}return n},[])};ac.intersect=function(f){var h=X.call(arguments,1);return ac.filter(ac.uniq(f),function(k){return ac.every(h,function(m){return ac.indexOf(m,k)>=0})})};ac.zip=function(){for(var f=X.call(arguments),h=ac.max(ac.pluck(f,"length")),m=Array(h),k=0;k<h;k++){m[k]=ac.pluck(f,""+k)}return m};ac.indexOf=function(f,h,m){if(f==null){return -1}if(m){m=ac.sortedIndex(f,h);return f[m]===h?m:-1}if(g&&f.indexOf===g){return f.indexOf(h)}m=0;for(var k=f.length;m<k;m++){if(f[m]===h){return m}}return -1};ac.lastIndexOf=function(f,h){if(f==null){return -1}if(ad&&f.lastIndexOf===ad){return f.lastIndexOf(h)}for(var k=f.length;k--;){if(f[k]===h){return k}}return -1};ac.range=function(f,m,s){var n=X.call(arguments),k=n.length<=1;f=k?0:n[0];m=k?n[0]:n[1];s=n[2]||1;n=Math.max(Math.ceil((m-f)/s),0);k=0;for(var h=Array(n);k<n;){h[k++]=f;f+=s}return h};ac.bind=function(f,h){var k=X.call(arguments,2);return function(){return f.apply(h||{},k.concat(X.call(arguments)))}};ac.bindAll=function(f){var h=X.call(arguments,1);if(h.length==0){h=ac.functions(f)}o(h,function(k){f[k]=ac.bind(f[k],f)});return f};ac.memoize=function(f,h){var k={};h=h||ac.identity;return function(){var m=h.apply(this,arguments);return m in k?k[m]:k[m]=f.apply(this,arguments)}};ac.delay=function(f,h){var k=X.call(arguments,2);return setTimeout(function(){return f.apply(f,k)},h)};ac.defer=function(f){return ac.delay.apply(ac,[f,1].concat(X.call(arguments,1)))};var B=function(f,h,m){var k;return function(){var u=this,n=arguments,s=function(){k=null;f.apply(u,n)};m&&clearTimeout(k);if(m||!k){k=setTimeout(s,h)}}};ac.throttle=function(f,h){return B(f,h,false)};ac.debounce=function(f,h){return B(f,h,true)};ac.wrap=function(f,h){return function(){var k=[f].concat(X.call(arguments));return h.apply(this,k)}};ac.compose=function(){var f=X.call(arguments);return function(){for(var h=X.call(arguments),k=f.length-1;k>=0;k--){h=[f[k].apply(this,h)]}return h[0]}};ac.keys=d||function(f){if(ac.isArray(f)){return ac.range(0,f.length)}var h=[],k;for(k in f){if(q.call(f,k)){h[h.length]=k}}return h};ac.values=function(f){return ac.map(f,ac.identity)};ac.functions=ac.methods=function(f){return ac.filter(ac.keys(f),function(h){return ac.isFunction(f[h])}).sort()};ac.extend=function(f){o(X.call(arguments,1),function(h){for(var k in h){f[k]=h[k]}});return f};ac.clone=function(f){return ac.isArray(f)?f.slice():ac.extend({},f)};ac.tap=function(f,h){h(f);return f};ac.isEqual=function(f,k){if(f===k){return true}var n=typeof f;if(n!=typeof k){return false}if(f==k){return true}if(!f&&k||f&&!k){return false}if(f._chain){f=f._wrapped}if(k._chain){k=k._wrapped}if(f.isEqual){return f.isEqual(k)}if(ac.isDate(f)&&ac.isDate(k)){return f.getTime()===k.getTime()}if(ac.isNaN(f)&&ac.isNaN(k)){return false}if(ac.isRegExp(f)&&ac.isRegExp(k)){return f.source===k.source&&f.global===k.global&&f.ignoreCase===k.ignoreCase&&f.multiline===k.multiline}if(n!=="object"){return false}if(f.length&&f.length!==k.length){return false}n=ac.keys(f);var m=ac.keys(k);if(n.length!=m.length){return false}for(var h in f){if(!(h in k)||!ac.isEqual(f[h],k[h])){return false}}return true};ac.isEmpty=function(f){if(ac.isArray(f)||ac.isString(f)){return f.length===0}for(var h in f){if(q.call(f,h)){return false}}return true};ac.isElement=function(f){return !!(f&&f.nodeType==1)};ac.isArray=e||function(f){return l.call(f)==="[object Array]"};ac.isArguments=function(f){return !!(f&&q.call(f,"callee"))};ac.isFunction=function(f){return !!(f&&f.constructor&&f.call&&f.apply)};ac.isString=function(f){return !!(f===""||f&&f.charCodeAt&&f.substr)};ac.isNumber=function(f){return !!(f===0||f&&f.toExponential&&f.toFixed)};ac.isNaN=function(f){return f!==f};ac.isBoolean=function(f){return f===true||f===false};ac.isDate=function(f){return !!(f&&f.getTimezoneOffset&&f.setUTCFullYear)};ac.isRegExp=function(f){return !!(f&&f.test&&f.exec&&(f.ignoreCase||f.ignoreCase===false))};ac.isNull=function(f){return f===null};ac.isUndefined=function(f){return f===void 0};ac.noConflict=function(){y._=c;return this};ac.identity=function(f){return f};ac.times=function(f,h,m){for(var k=0;k<f;k++){h.call(m,k)}};ac.mixin=function(f){o(ac.functions(f),function(h){Q(h,ac[h]=f[h])})};var Y=0;ac.uniqueId=function(f){var h=Y++;return f?f+h:h};ac.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};ac.template=function(f,h){var k=ac.templateSettings;k="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+f.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(k.interpolate,function(n,m){return"',"+m.replace(/\\'/g,"'")+",'"}).replace(k.evaluate||null,function(n,m){return"');"+m.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";k=new Function("obj",k);return h?k(h):k};var K=function(f){this._wrapped=f};ac.prototype=K.prototype;var V=function(f,h){return h?ac(f).chain():f},Q=function(f,h){K.prototype[f]=function(){var k=X.call(arguments);P.call(k,this._wrapped);return V(h.apply(ac,k),this._chain)}};ac.mixin(ac);o(["pop","push","reverse","shift","sort","splice","unshift"],function(f){var h=T[f];K.prototype[f]=function(){h.apply(this._wrapped,arguments);return V(this._wrapped,this._chain)}});o(["concat","join","slice"],function(f){var h=T[f];K.prototype[f]=function(){return V(h.apply(this._wrapped,arguments),this._chain)}});K.prototype.chain=function(){this._chain=true;return this};K.prototype.value=function(){return this._wrapped}})();(function(){var o=this,c=o.Backbone,i;i=typeof exports!=="undefined"?exports:o.Backbone={};i.VERSION="0.5.1";var v=o._;if(!v&&typeof require!=="undefined"){v=require("underscore")._}var e=o.jQuery||o.Zepto;i.noConflict=function(){o.Backbone=c;return this};i.emulateHTTP=false;i.emulateJSON=false;i.Events={bind:function(k,n){var h=this._callbacks||(this._callbacks={});(h[k]||(h[k]=[])).push(n);return this},unbind:function(s,w){var n;if(s){if(n=this._callbacks){if(w){n=n[s];if(!n){return this}for(var k=0,h=n.length;k<h;k++){if(w===n[k]){n[k]=null;break}}}else{n[s]=[]}}}else{this._callbacks={}}return this},trigger:function(x){var E,s,n,k,w=2;if(!(s=this._callbacks)){return this}for(;w--;){if(E=w?x:"all",E=s[E]){for(var h=0,C=E.length;h<C;h++){(n=E[h])?(k=w?Array.prototype.slice.call(arguments,1):arguments,n.apply(this,k)):(E.splice(h,1),h--,C--)}}}return this}};i.Model=function(k,n){var h;k||(k={});if(h=this.defaults){v.isFunction(h)&&(h=h());k=v.extend({},h,k)}this.attributes={};this._escapedAttributes={};this.cid=v.uniqueId("c");this.set(k,{silent:true});this._changed=false;this._previousAttributes=v.clone(this.attributes);if(n&&n.collection){this.collection=n.collection}this.initialize(k,n)};v.extend(i.Model.prototype,i.Events,{_previousAttributes:null,_changed:false,idAttribute:"id",initialize:function(){},toJSON:function(){return v.clone(this.attributes)},get:function(h){return this.attributes[h]},escape:function(h){var k;if(k=this._escapedAttributes[h]){return k}k=this.attributes[h];return this._escapedAttributes[h]=(k==null?"":""+k).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27").replace(/\//g,"&#x2F;")},has:function(h){return this.attributes[h]!=null},set:function(x,C){C||(C={});if(!x){return this}if(x.attributes){x=x.attributes}var s=this.attributes,n=this._escapedAttributes;if(!C.silent&&this.validate&&!this._performValidation(x,C)){return false}if(this.idAttribute in x){this.id=x[this.idAttribute]}var k=this._changing;this._changing=true;for(var w in x){var h=x[w];if(!v.isEqual(s[w],h)){s[w]=h;delete n[w];this._changed=true;C.silent||this.trigger("change:"+w,this,h,C)}}!k&&!C.silent&&this._changed&&this.change(C);this._changing=false;return this},unset:function(k,n){if(!(k in this.attributes)){return this}n||(n={});var h={};h[k]=void 0;if(!n.silent&&this.validate&&!this._performValidation(h,n)){return false}delete this.attributes[k];delete this._escapedAttributes[k];k==this.idAttribute&&delete this.id;this._changed=true;n.silent||(this.trigger("change:"+k,this,void 0,n),this.change(n));return this},clear:function(n){n||(n={});var s,k=this.attributes,h={};for(s in k){h[s]=void 0}if(!n.silent&&this.validate&&!this._performValidation(h,n)){return false}this.attributes={};this._escapedAttributes={};this._changed=true;if(!n.silent){for(s in k){this.trigger("change:"+s,this,void 0,n)}this.change(n)}return this},fetch:function(k){k||(k={});var n=this,h=k.success;k.success=function(w,s,x){if(!n.set(n.parse(w,x),k)){return false}h&&h(n,w)};k.error=d(k.error,n,k);return(this.sync||i.sync).call(this,"read",this,k)},save:function(s,w){w||(w={});if(s&&!this.set(s,w)){return false}var n=this,k=w.success;w.success=function(C,x,E){if(!n.set(n.parse(C,E),w)){return false}k&&k(n,C,E)};w.error=d(w.error,n,w);var h=this.isNew()?"create":"update";return(this.sync||i.sync).call(this,h,this,w)},destroy:function(k){k||(k={});if(this.isNew()){return this.trigger("destroy",this,this.collection,k)}var n=this,h=k.success;k.success=function(s){n.trigger("destroy",n,n.collection,k);h&&h(n,s)};k.error=d(k.error,n,k);return(this.sync||i.sync).call(this,"delete",this,k)},url:function(){var h=f(this.collection)||this.urlRoot||B();if(this.isNew()){return h}return h+(h.charAt(h.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(h){return h},clone:function(){return new this.constructor(this)},isNew:function(){return this.id==null},change:function(h){this.trigger("change",this,h);this._previousAttributes=v.clone(this.attributes);this._changed=false},hasChanged:function(h){if(h){return this._previousAttributes[h]!=this.attributes[h]}return this._changed},changedAttributes:function(n){n||(n=this.attributes);var s=this._previousAttributes,k=false,h;for(h in n){v.isEqual(s[h],n[h])||(k=k||{},k[h]=n[h])}return k},previous:function(h){if(!h||!this._previousAttributes){return null}return this._previousAttributes[h]},previousAttributes:function(){return v.clone(this._previousAttributes)},_performValidation:function(k,n){var h=this.validate(k);if(h){return n.error?n.error(this,h,n):this.trigger("error",this,h,n),false}return true}});i.Collection=function(h,k){k||(k={});if(k.comparator){this.comparator=k.comparator}v.bindAll(this,"_onModelEvent","_removeReference");this._reset();h&&this.reset(h,{silent:true});this.initialize.apply(this,arguments)};v.extend(i.Collection.prototype,i.Events,{model:i.Model,initialize:function(){},toJSON:function(){return this.map(function(h){return h.toJSON()})},add:function(n,s){if(v.isArray(n)){for(var k=0,h=n.length;k<h;k++){this._add(n[k],s)}}else{this._add(n,s)}return this},remove:function(n,s){if(v.isArray(n)){for(var k=0,h=n.length;k<h;k++){this._remove(n[k],s)}}else{this._remove(n,s)}return this},get:function(h){if(h==null){return null}return this._byId[h.id!=null?h.id:h]},getByCid:function(h){return h&&this._byCid[h.cid||h]},at:function(h){return this.models[h]},sort:function(h){h||(h={});if(!this.comparator){throw Error("Cannot sort a set without a comparator")}this.models=this.sortBy(this.comparator);h.silent||this.trigger("reset",this,h);return this},pluck:function(h){return v.map(this.models,function(k){return k.get(h)})},reset:function(h,k){h||(h=[]);k||(k={});this.each(this._removeReference);this._reset();this.add(h,{silent:true});k.silent||this.trigger("reset",this,k);return this},fetch:function(k){k||(k={});var n=this,h=k.success;k.success=function(w,s,x){n[k.add?"add":"reset"](n.parse(w,x),k);h&&h(n,w)};k.error=d(k.error,n,k);return(this.sync||i.sync).call(this,"read",this,k)},create:function(n,s){var k=this;s||(s={});n=this._prepareModel(n,s);if(!n){return false}var h=s.success;s.success=function(x,C,w){k.add(x,s);h&&h(x,C,w)};n.save(null,s);return n},parse:function(h){return h},chain:function(){return v(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(k,n){if(k instanceof i.Model){if(!k.collection){k.collection=this}}else{var h=k;k=new this.model(h,{collection:this});k.validate&&!k._performValidation(h,n)&&(k=false)}return k},_add:function(k,n){n||(n={});k=this._prepareModel(k,n);if(!k){return false}var h=this.getByCid(k)||this.get(k);if(h){throw Error(["Can't add the same model to a set twice",h.id])}this._byId[k.id]=k;this._byCid[k.cid]=k;this.models.splice(n.at!=null?n.at:this.comparator?this.sortedIndex(k,this.comparator):this.length,0,k);k.bind("all",this._onModelEvent);this.length++;n.silent||k.trigger("add",k,this,n);return k},_remove:function(h,k){k||(k={});h=this.getByCid(h)||this.get(h);if(!h){return null}delete this._byId[h.id];delete this._byCid[h.cid];this.models.splice(this.indexOf(h),1);this.length--;k.silent||h.trigger("remove",h,this,k);this._removeReference(h);return h},_removeReference:function(h){this==h.collection&&delete h.collection;h.unbind("all",this._onModelEvent)},_onModelEvent:function(n,s,k,h){(n=="add"||n=="remove")&&k!=this||(n=="destroy"&&this._remove(s,h),s&&n==="change:"+s.idAttribute&&(delete this._byId[s.previous(s.idAttribute)],this._byId[s.id]=s),this.trigger.apply(this,arguments))}});v.each(["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty"],function(h){i.Collection.prototype[h]=function(){return v[h].apply(v,[this.models].concat(v.toArray(arguments)))}});i.Router=function(h){h||(h={});if(h.routes){this.routes=h.routes}this._bindRoutes();this.initialize.apply(this,arguments)};var y=/:([\w\d]+)/g,r=/\*([\w\d]+)/g,j=/[-[\]{}()+?.,\\^$|#\s]/g;v.extend(i.Router.prototype,i.Events,{initialize:function(){},route:function(k,n,h){i.history||(i.history=new i.History);v.isRegExp(k)||(k=this._routeToRegExp(k));i.history.route(k,v.bind(function(s){s=this._extractParameters(k,s);h.apply(this,s);this.trigger.apply(this,["route:"+n].concat(s))},this))},navigate:function(h,k){i.history.navigate(h,k)},_bindRoutes:function(){if(this.routes){var k=[],n;for(n in this.routes){k.unshift([n,this.routes[n]])}n=0;for(var h=k.length;n<h;n++){this.route(k[n][0],k[n][1],this[k[n][1]])}}},_routeToRegExp:function(h){h=h.replace(j,"\\$&").replace(y,"([^/]*)").replace(r,"(.*?)");return RegExp("^"+h+"$")},_extractParameters:function(h,k){return h.exec(k).slice(1)}});i.History=function(){this.handlers=[];v.bindAll(this,"checkUrl")};var l=/^#*/,m=/msie [\w.]+/,A=false;v.extend(i.History.prototype,{interval:50,getFragment:function(k,n){if(k==null){if(this._hasPushState||n){k=window.location.pathname;var h=window.location.search;h&&(k+=h);k.indexOf(this.options.root)==0&&(k=k.substr(this.options.root.length))}else{k=window.location.hash}}return k.replace(l,"")},start:function(h){if(A){throw Error("Backbone.history has already been started")}this.options=v.extend({},{root:"/"},this.options,h);this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);h=this.getFragment();var k=document.documentMode;if(k=m.exec(navigator.userAgent.toLowerCase())&&(!k||k<=7)){this.iframe=e('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(h)}this._hasPushState?e(window).bind("popstate",this.checkUrl):"onhashchange" in window&&!k?e(window).bind("hashchange",this.checkUrl):setInterval(this.checkUrl,this.interval);this.fragment=h;A=true;h=window.location;k=h.pathname==this.options.root;if(this._wantsPushState&&!this._hasPushState&&!k){this.fragment=this.getFragment(null,true);window.location.replace(this.options.root+"#"+this.fragment)}else{if(this._wantsPushState&&this._hasPushState&&k&&h.hash){this.fragment=h.hash.replace(l,"");window.history.replaceState({},document.title,h.protocol+"//"+h.host+this.options.root+this.fragment)}}return this.loadUrl()},route:function(h,k){this.handlers.unshift({route:h,callback:k})},checkUrl:function(){var h=this.getFragment();h==this.fragment&&this.iframe&&(h=this.getFragment(this.iframe.location.hash));if(h==this.fragment||h==decodeURIComponent(this.fragment)){return false}this.iframe&&this.navigate(h);this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(h){var k=this.fragment=this.getFragment(h);return v.any(this.handlers,function(n){if(n.route.test(k)){return n.callback(k),true}})},navigate:function(n,s){var k=(n||"").replace(l,"");if(!(this.fragment==k||this.fragment==decodeURIComponent(k))){if(this._hasPushState){var h=window.location;k.indexOf(this.options.root)!=0&&(k=this.options.root+k);this.fragment=k;window.history.pushState({},document.title,h.protocol+"//"+h.host+k)}else{if(window.location.hash=this.fragment=k,this.iframe&&k!=this.getFragment(this.iframe.location.hash)){this.iframe.document.open().close();this.iframe.location.hash=k}}s&&this.loadUrl(n)}}});i.View=function(h){this.cid=v.uniqueId("view");this._configure(h||{});this._ensureElement();this.delegateEvents();this.initialize.apply(this,arguments)};var z=/^(\S+)\s*(.*)$/,u=["model","collection","el","id","attributes","className","tagName"];v.extend(i.View.prototype,i.Events,{tagName:"div",$:function(h){return e(h,this.el)},initialize:function(){},render:function(){return this},remove:function(){e(this.el).remove();return this},make:function(k,n,h){k=document.createElement(k);n&&e(k).attr(n);h&&e(k).html(h);return k},delegateEvents:function(s){if(s||(s=this.events)){for(var w in e(this.el).unbind(".delegateEvents"+this.cid),s){var n=this[s[w]];if(!n){throw Error('Event "'+s[w]+'" does not exist')}var k=w.match(z),h=k[1];k=k[2];n=v.bind(n,this);h+=".delegateEvents"+this.cid;k===""?e(this.el).bind(h,n):e(this.el).delegate(k,h,n)}}},_configure:function(n){this.options&&(n=v.extend({},this.options,n));for(var s=0,k=u.length;s<k;s++){var h=u[s];n[h]&&(this[h]=n[h])}this.options=n},_ensureElement:function(){if(this.el){if(v.isString(this.el)){this.el=e(this.el).get(0)}}else{var h=this.attributes||{};if(this.id){h.id=this.id}if(this.className){h["class"]=this.className}this.el=this.make(this.tagName,h)}}});i.Model.extend=i.Collection.extend=i.Router.extend=i.View.extend=function(k,n){var h=g(this,k,n);h.extend=this.extend;return h};var p={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};i.sync=function(n,s,k){var h=p[n];k=v.extend({type:h,dataType:"json",processData:false},k);if(!k.url){k.url=f(s)||B()}if(!k.data&&s&&(n=="create"||n=="update")){k.contentType="application/json";k.data=JSON.stringify(s.toJSON())}if(i.emulateJSON){k.contentType="application/x-www-form-urlencoded";k.processData=true;k.data=k.data?{model:k.data}:{}}if(i.emulateHTTP&&(h==="PUT"||h==="DELETE")){if(i.emulateJSON){k.data._method=h}k.type="POST";k.beforeSend=function(w){w.setRequestHeader("X-HTTP-Method-Override",h)}}return e.ajax(k)};var q=function(){},g=function(n,s,k){var h;h=s&&s.hasOwnProperty("constructor")?s.constructor:function(){return n.apply(this,arguments)};v.extend(h,n);q.prototype=n.prototype;h.prototype=new q;s&&v.extend(h.prototype,s);k&&v.extend(h,k);h.prototype.constructor=h;h.__super__=n.prototype;return h},f=function(h){if(!h||!h.url){return null}return v.isFunction(h.url)?h.url():h.url},B=function(){throw Error('A "url" property or function must be specified')},d=function(k,n,h){return function(s){k?k(n,s,h):n.trigger("error",n,s,h)}}}).call(this);window.debug=function(){function o(h){if(e&&(q||!c||!c.log)){e.apply(d,h)}}for(var d=this,j=Array.prototype.slice,c=d.console,f={},e,q,l=9,m=["error","warn","info","debug","log"],p="assert clear count dir dirxml exception group groupCollapsed groupEnd profile profileEnd table time timeEnd trace".split(" "),i=p.length,g=[];--i>=0;){(function(h){f[h]=function(){l!==0&&c&&c[h]&&c[h].apply(c,arguments)}})(p[i])}for(i=m.length;--i>=0;){(function(k,h){f[h]=function(){var n=j.call(arguments),r=[h].concat(n);g.push(r);o(r);if(c&&(l>0?l>k:m.length+l<=k)){c.firebug?c[h].apply(d,n):c[h]?c[h](n):c.log(n)}}})(i,m[i])}f.setLevel=function(h){l=typeof h==="number"?h:9};f.setCallback=function(){var k=j.call(arguments),h=g.length,n=h;e=k.shift()||null;q=typeof k[0]==="boolean"?k.shift():false;for(n-=typeof k[0]==="number"?k.shift():h;n<h;){o(g[n++])}};return f}();(function(r){function c(h,k,f,n){n={data:n||n===0||n===false?n:k?k.data:{},_wrap:k?k._wrap:null,tmpl:null,parent:k||null,nodes:[],calls:p,nest:q,wrap:P,html:L,update:D};h&&r.extend(n,h,{nodes:[],parent:k});if(f){n.tmpl=f;n._ctnt=n._ctnt||n.tmpl(r,n);n.key=++m;(u.length?R:g)[m]=n}return n}function j(h,k,f){var n;f=f?r.map(f,function(s){return typeof s==="string"?h.key?s.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+A+'="'+h.key+'" $2'):s:j(s,h,s._ctnt)}):h;if(k){return f}f=f.join("");f.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(s,v,x,w){n=r(x).get();l(n);if(v){n=I(v).concat(n)}if(w){n=n.concat(I(w))}});return n?n:I(f)}function I(f){var h=document.createElement("div");h.innerHTML=f;return r.makeArray(h.childNodes)}function e(f){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+r.trim(f).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(n,h,s,k,v,x,w){n=r.tmpl.tag[s];if(!n){throw"Unknown template tag: "+s}s=n._default||[];if(x&&!/\w$/.test(v)){v+=x;x=""}if(v){v=B(v);w=w?","+B(w)+")":x?")":"";w=x?v.indexOf(".")>-1?v+B(x):"("+v+").call($item"+w:v;x=x?w:"(typeof("+v+")==='function'?("+v+").call($item):("+v+"))"}else{x=w=s.$1||"null"}k=B(k);return"');"+n[h?"close":"open"].split("$notnull_1").join(v?"typeof("+v+")!=='undefined' && ("+v+")!=null":"true").split("$1a").join(x).split("$1").join(w).split("$2").join(k||s.$2||"")+"__.push('"})+"');}return __;")}function K(f,h){f._wrap=j(f,true,r.isArray(h)?h:[i.test(h)?h:r(h).html()]).join("")}function B(f){return f?f.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function l(s){function z(C){function G(M){M+=n;F=k[M]=k[M]||c(F,g[F.parent.key+n]||F.parent)}var E,J=C,F,H;if(H=C.getAttribute(A)){for(;J.parentNode&&(J=J.parentNode).nodeType===1&&!(E=J.getAttribute(A));){}if(E!==H){J=J.parentNode?J.nodeType===11?0:J.getAttribute(A)||0:0;if(!(F=g[H])){F=R[H];F=c(F,g[J]||R[J]);F.key=++m;g[m]=F}o&&G(H)}C.removeAttribute(A)}else{if(o&&(F=r.data(C,"tmplItem"))){G(F.key);g[F.key]=F;J=(J=r.data(C.parentNode,"tmplItem"))?J.key:0}}if(F){for(E=F;E&&E.key!=J;){E.nodes.push(C);E=E.parent}delete F._ctnt;delete F._wrap;r.data(C,"tmplItem",F)}}var n="_"+o,f,v,k={},x,h,w;x=0;for(h=s.length;x<h;x++){if((f=s[x]).nodeType===1){v=f.getElementsByTagName("*");for(w=v.length-1;w>=0;w--){z(v[w])}z(f)}}}function p(h,k,f,n){if(!h){return u.pop()}u.push({_:h,tmpl:k,item:this,data:f,options:n})}function q(h,k,f){return r.tmpl(r.template(h),k,f,this)}function P(h,k){var f=h.options||{};f.wrapped=k;return r.tmpl(r.template(h.tmpl),h.data,f,h.item)}function L(h,k){var f=this._wrap;return r.map(r(r.isArray(f)?f.join(""):f).filter(h||"*"),function(s){if(k){s=s.innerText||s.textContent}else{var n;if(!(n=s.outerHTML)){n=document.createElement("div");n.appendChild(s.cloneNode(true));n=n.innerHTML}s=n}return s})}function D(){var f=this.nodes;r.tmpl(null,null,null,this).insertBefore(f[0]);r(f).remove()}var y=r.fn.domManip,A="_tmplitem",i=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,g={},R={},d,Q={key:0,data:{}},m=0,o=0,u=[];r.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(f,h){r.fn[f]=function(k){var s=[];k=r(k);var n,v,w;n=this.length===1&&this[0].parentNode;d=g||{};if(n&&n.nodeType===11&&n.childNodes.length===1&&k.length===1){k[h](this[0]);s=this}else{v=0;for(w=k.length;v<w;v++){o=v;n=(v>0?this.clone(true):this).get();r(k[v])[h](n);s=s.concat(n)}o=0;s=this.pushStack(s,f,k.selector)}k=d;d=null;r.tmpl.complete(k);return s}});r.fn.extend({tmpl:function(h,k,f){return r.tmpl(this[0],h,k,f)},tmplItem:function(){return r.tmplItem(this[0])},template:function(f){return r.template(f,this[0])},domManip:function(h,n,f){if(h[0]&&r.isArray(h[0])){for(var s=r.makeArray(arguments),k=h[0],v=k.length,x=0,w;x<v&&!(w=r.data(k[x++],"tmplItem"));){}if(w&&o){s[2]=function(z){r.tmpl.afterManip(this,z,f)}}y.apply(this,s)}else{y.apply(this,arguments)}o=0;d||r.tmpl.complete(g);return this}});r.extend({tmpl:function(h,n,f,s){var k=!s;if(k){s=Q;h=r.template[h]||r.template(null,h);R={}}else{if(!h){h=s.tmpl;g[s.key]=s;s.nodes=[];s.wrapped&&K(s,s.wrapped);return r(j(s,null,s.tmpl(r,s)))}}if(!h){return[]}if(typeof n==="function"){n=n.call(s||{})}f&&f.wrapped&&K(f,f.wrapped);n=r.isArray(n)?r.map(n,function(v){return v?c(f,s,h,v):null}):[c(f,s,h,n)];return k?r(j(s,null,n)):n},tmplItem:function(f){var h;if(f instanceof r){f=f[0]}for(;f&&f.nodeType===1&&!(h=r.data(f,"tmplItem"))&&(f=f.parentNode);){}return h||Q},template:function(f,h){if(h){if(typeof h==="string"){h=e(h)}else{if(h instanceof r){h=h[0]||{}}}if(h.nodeType){h=r.data(h,"tmpl")||r.data(h,"tmpl",e(h.innerHTML))}return typeof f==="string"?r.template[f]=h:h}return f?typeof f!=="string"?r.template(null,f):r.template[f]||r.template(null,i.test(f)?f:r(f)):null},encode:function(f){return(""+f).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});r.extend(r.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(){g={}},afterManip:function(h,k,f){var n=k.nodeType===11?r.makeArray(k.childNodes):k.nodeType===1?[k]:[];f.call(h,k);l(n);o++}})})(jQuery);(function(c){function d(i){var g=i||window.event,k=[].slice.call(arguments,1),h=0,j=0,f=0;i=c.event.fix(g);i.type="mousewheel";if(i.wheelDelta){h=i.wheelDelta/120}if(i.detail){h=-i.detail/3}f=h;if(g.axis!==undefined&&g.axis===g.HORIZONTAL_AXIS){f=0;j=-1*h}if(g.wheelDeltaY!==undefined){f=g.wheelDeltaY/120}if(g.wheelDeltaX!==undefined){j=-1*g.wheelDeltaX/120}k.unshift(i,h,j,f);return c.event.handle.apply(this,k)}var e=["DOMMouseScroll","mousewheel"];c.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var f=e.length;f;){this.addEventListener(e[--f],d,false)}}else{this.onmousewheel=d}},teardown:function(){if(this.removeEventListener){for(var f=e.length;f;){this.removeEventListener(e[--f],d,false)}}else{this.onmousewheel=null}}};c.fn.extend({mousewheel:function(f){return f?this.bind("mousewheel",f):this.trigger("mousewheel")},unmousewheel:function(f){return this.unbind("mousewheel",f)}})})(jQuery);(function(o){function d(){if(m){window.clearTimeout(i);m=false;p=null}}function j(h){if(!m){m=true;p=h.changedTouches[0];i=window.setTimeout(function(){m=false;var k=p,n=document.createEvent("MouseEvent");n.initMouseEvent("mouseup",true,true,window,1,k.screenX,k.screenY,k.clientX,k.clientY,false,false,false,false,0,null);k.target.dispatchEvent(n);n=document.createEvent("MouseEvent");n.initMouseEvent("mousedown",true,true,window,1,k.screenX,k.screenY,k.clientX,k.clientY,false,false,false,false,2,null);k.target.dispatchEvent(n);n=document.createEvent("MouseEvent");n.initMouseEvent("contextmenu",true,true,window,1,k.screenX+50,k.screenY+5,k.clientX+50,k.clientY+5,false,false,false,false,2,null);k.target.dispatchEvent(n);g=true;p=null},800)}}function c(k){var h=k.changedTouches[0],n="mouseover",r=document.createEvent("MouseEvent");r.initMouseEvent(n,true,true,window,1,h.screenX,h.screenY,h.clientX,h.clientY,false,false,false,false,0,null);h.target.dispatchEvent(r);n="mousedown";r=document.createEvent("MouseEvent");r.initMouseEvent(n,true,true,window,1,h.screenX,h.screenY,h.clientX,h.clientY,false,false,false,false,0,null);h.target.dispatchEvent(r);if(q){window.clearTimeout(l);if(h.target==e){e=null;q=false;n="click";r=document.createEvent("MouseEvent");r.initMouseEvent(n,true,true,window,1,h.screenX,h.screenY,h.clientX,h.clientY,false,false,false,false,0,null);h.target.dispatchEvent(r);n="dblclick";r=document.createEvent("MouseEvent");r.initMouseEvent(n,true,true,window,1,h.screenX,h.screenY,h.clientX,h.clientY,false,false,false,false,0,null);h.target.dispatchEvent(r)}else{e=h.target;q=true;l=window.setTimeout(function(){q=false},600);j(k)}}else{e=h.target;q=true;l=window.setTimeout(function(){q=false},600);j(k)}}function f(k){var h="";if(!(k.touches.length>1)){switch(k.type){case"gesturestart":alert("gesturestart");k.preventDefault();break;case"touchstart":if(o(k.changedTouches[0].target).is("select")){return}c(k);k.preventDefault();return false;case"touchmove":d();h="mousemove";k.preventDefault();break;case"touchend":if(g){g=false;k.preventDefault();return false}d();h="mouseup";break;default:return}k=k.changedTouches[0];var n=document.createEvent("MouseEvent");n.initMouseEvent(h,true,true,window,1,k.screenX,k.screenY,k.clientX,k.clientY,false,false,false,false,0,null);k.target.dispatchEvent(n);if(h=="mouseup"&&q&&k.target==e){n=document.createEvent("MouseEvent");n.initMouseEvent("click",true,true,window,1,k.screenX,k.screenY,k.clientX,k.clientY,false,false,false,false,0,null);k.target.dispatchEvent(n)}}}o.extend(o.support,{touch:typeof Touch=="object"});o.fn.addTouch=function(){o.support.touch&&this.each(function(k,h){h.addEventListener("touchstart",f,false);h.addEventListener("touchmove",f,false);h.addEventListener("touchend",f,false);h.addEventListener("touchcancel",f,false)})};var e=null,q=false,l=null,m=false,p=null,i=null,g=false})(jQuery);(function(){function at(){if(at.is(arguments[0],aW)){for(var f=arguments[0],n=bH[aV](at,f.splice(0,3+at.is(f[0],aY))),m=n.set(),j=0,h=f[aB];j<h;j++){var k=f[j]||{};a2[aI](k.type)&&m[bv](n[k.type]().attr(k))}return m}return bH[aV](at,arguments)}function aQ(){for(var f=[],h=0;h<32;h++){f[h]=(~~(bn.random()*16))[bD](16)}f[12]=4;f[16]=(f[16]&3|8)[bD](16);return"r-"+f[au]("")}function a1(f,k,j){function h(){var n=Array[a8].slice.call(arguments,0),s=n[au]("\u25ba"),m=h.cache=h.cache||{},o=h.count=h.count||[];if(m[aI](s)){return j?j(m[s]):m[s]}o[aB]>=1000&&delete m[o.shift()];o[bv](s);m[s]=f[aV](k,n);return j?j(m[s]):m[s]}return h}function bj(){return this.x+aT+this.y}function aU(f){return function(n,m,j,h){var k={back:f};at.is(j,"function")?h=j:k.rot=j;n&&n.constructor==aF&&(n=n.attrs.path);n&&(k.along=n);return this.animate(k,m,h)}}function aA(x,v,s,n,m,o){function k(A,C){var z,D,E,B;E=A;for(D=0;D<8;D++){B=((f*E+h)*E+j)*E-A;if(ax(B)<C){return E}z=(3*f*E+2*h)*E+j;if(ax(z)<0.000001){break}E-=B/z}z=0;D=1;E=A;if(E<z){return z}if(E>D){return D}for(;z<D;){B=((f*E+h)*E+j)*E;if(ax(B-A)<C){break}A>B?z=E:D=E;E=(D-z)/2+z}return E}var j=3*v,h=3*(n-v)-j,f=1-j-h,y=3*s,w=3*(m-s)-y,u=1-y-w;return function(A,B){var z=k(A,B);return((u*z+w)*z+y)*z}(x,1/(200*o))}at.version="1.5.2";var bf=/[, ]+/,a2={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},ar=/\{(\d+)\}/g,a8="prototype",aI="hasOwnProperty",aC=document,aw=window,a9={was:Object[a8][aI].call(aw,"Raphael"),is:aw.Raphael},bd=function(){this.customAttributes={}},a0,aV="apply",ae="createTouch" in aC,aT=" ",aJ=String,ao="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend".split(aT),a5={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},au="join",aB="length",av=aJ[a8].toLowerCase,bn=Math,bh=bn.max,aE=bn.min,ax=bn.abs,ap=bn.pow,bl=bn.PI,aY="number",aW="array",bD="toString",q=Object[a8][bD],bv="push",bN=/^url\(['"]?([^\)]+?)['"]?\)$/i,bR=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,by={NaN:1,Infinity:1,"-Infinity":1},bV=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,aZ=bn.round,aS=parseFloat,bg=parseInt,V=aJ[a8].toUpperCase,ah={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},bq={along:"along",blur:aY,"clip-rect":"csv",cx:aY,cy:aY,fill:"colour","fill-opacity":aY,"font-size":aY,height:aY,opacity:aY,path:"path",r:aY,rotation:"csv",rx:aY,ry:aY,scale:"csv",stroke:"colour","stroke-opacity":aY,"stroke-width":aY,translation:"csv",width:aY,x:aY,y:aY},aN=/^(from|to|\d+%?)$/,aP=/\s*,\s*/,al={hs:1,rg:1},T=/,?([achlmqrstvxz]),?/gi,c=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,bI=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig,bK=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,br=function(f,h){return f.key-h.key};at.type=aw.SVGAngle||aC.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if(at.type=="VML"){var bp=aC.createElement("div");bp.innerHTML='<v:shape adj="1"/>';bp=bp.firstChild;bp.style.behavior="url(#default#VML)";if(!(bp&&typeof bp.adj=="object")){return at.type=null}bp=null}at.svg=!(at.vml=at.type=="VML");bd[a8]=at[a8];a0=bd[a8];at._id=0;at._oid=0;at.fn={};at.is=function(f,h){h=av.call(h);if(h=="finite"){return !by[aI](+f)}return h=="null"&&f===null||h==typeof f||h=="object"&&f===Object(f)||h=="array"&&Array.isArray&&Array.isArray(f)||q.call(f).slice(8,-1).toLowerCase()==h};at.angle=function(f,n,m,j,h,k){if(h==null){f-=m;n-=j;if(!f&&!n){return 0}return((f<0)*180+bn.atan(-n/-f)*180/bl+360)%360}return at.angle(f,n,h,k)-at.angle(m,j,h,k)};at.rad=function(f){return f%360*bl/180};at.deg=function(f){return f*180/bl%360};at.snapTo=function(f,k,j){j=at.is(j,"finite")?j:10;if(at.is(f,aW)){for(var h=f.length;h--;){if(ax(f[h]-k)<=j){return f[h]}}}else{f=+f;h=k%f;if(h<j){return k-h}if(h>f-j){return k-h+f}}return k};at.setWindow=function(f){aw=f;aC=aw.document};var r=function(h){if(at.vml){var o=/^\s+|\s+$/g,n;try{var k=new ActiveXObject("htmlfile");k.write("<body>");k.close();n=k.body}catch(j){n=createPopup().document.body}var m=n.createTextRange();r=a1(function(v){try{n.style.color=aJ(v).replace(o,"");var u=m.queryCommandValue("ForeColor");return"#"+("000000"+((u&255)<<16|u&65280|(u&16711680)>>>16)[bD](16)).slice(-6)}catch(s){return"none"}})}else{var f=aC.createElement("i");f.title="Rapha\u00ebl Colour Picker";f.style.display="none";aC.body.appendChild(f);r=a1(function(s){f.style.color=s;return aC.defaultView.getComputedStyle(f,"").getPropertyValue("color")})}return r(h)},bk=function(){return"hsb("+[this.h,this.s,this.b]+")"},bM=function(){return"hsl("+[this.h,this.s,this.l]+")"},bx=function(){return this.hex};at.hsb2rgb=function(f,k,j,h){if(at.is(f,"object")&&"h" in f&&"s" in f&&"b" in f){j=f.b;k=f.s;f=f.h;h=f.o}return at.hsl2rgb(f,k,j/2,h)};at.hsl2rgb=function(h,s,o,k){if(at.is(h,"object")&&"h" in h&&"s" in h&&"l" in h){o=h.l;s=h.s;h=h.h}if(h>1||s>1||o>1){h/=360;s/=100;o/=100}var j={},n=["r","g","b"],f;if(s){o<0.5?f=o*(1+s):f=o+s-o*s;s=2*o-f;for(var m=0;m<3;m++){o=h+1/3*-(m-1);o<0&&o++;o>1&&o--;o*6<1?j[n[m]]=s+(f-s)*6*o:o*2<1?j[n[m]]=f:o*3<2?j[n[m]]=s+(f-s)*(2/3-o)*6:j[n[m]]=s}}else{j={r:o,g:o,b:o}}j.r*=255;j.g*=255;j.b*=255;j.hex="#"+(16777216|j.b|j.g<<8|j.r<<16).toString(16).slice(1);at.is(k,"finite")&&(j.opacity=k);j.toString=bx;return j};at.rgb2hsb=function(f,n,m){if(n==null&&at.is(f,"object")&&"r" in f&&"g" in f&&"b" in f){m=f.b;n=f.g;f=f.r}if(n==null&&at.is(f,"string")){m=at.getRGB(f);f=m.r;n=m.g;m=m.b}if(f>1||n>1||m>1){f/=255;n/=255;m/=255}var j=bh(f,n,m),h=aE(f,n,m),k;if(h==j){return{h:0,s:0,b:j,toString:bk}}h=j-h;f==j?k=(n-m)/h:n==j?k=2+(m-f)/h:k=4+(f-n)/h;k/=6;k<0&&k++;k>1&&k--;return{h:k,s:h/j,b:j,toString:bk}};at.rgb2hsl=function(h,s,o){if(s==null&&at.is(h,"object")&&"r" in h&&"g" in h&&"b" in h){o=h.b;s=h.g;h=h.r}if(s==null&&at.is(h,"string")){o=at.getRGB(h);h=o.r;s=o.g;o=o.b}if(h>1||s>1||o>1){h/=255;s/=255;o/=255}var k=bh(h,s,o),j=aE(h,s,o),n,f=(k+j)/2;if(j==k){h={h:0,s:0,l:f}}else{var m=k-j;h==k?n=(s-o)/m:s==k?n=2+(o-h)/m:n=4+(h-s)/m;n/=6;n<0&&n++;n>1&&n--;h={h:n,s:f<0.5?m/(k+j):m/(2-k-j),l:f}}h.toString=bM;return h};at._path2string=function(){return this.join(",").replace(T,"$1")};at.getRGB=a1(function(f){if(!f||(f=aJ(f)).indexOf("-")+1){return{r:-1,g:-1,b:-1,hex:"none",error:1}}if(f=="none"){return{r:-1,g:-1,b:-1,hex:"none"}}!(al[aI](f.toLowerCase().substring(0,2))||f.charAt()=="#")&&(f=r(f));var n,m,j,h,k;if(f=f.match(bR)){if(f[2]){j=bg(f[2].substring(5),16);m=bg(f[2].substring(3,5),16);n=bg(f[2].substring(1,3),16)}if(f[3]){j=bg((k=f[3].charAt(3))+k,16);m=bg((k=f[3].charAt(2))+k,16);n=bg((k=f[3].charAt(1))+k,16)}if(f[4]){k=f[4].split(aP);n=aS(k[0]);k[0].slice(-1)=="%"&&(n*=2.55);m=aS(k[1]);k[1].slice(-1)=="%"&&(m*=2.55);j=aS(k[2]);k[2].slice(-1)=="%"&&(j*=2.55);f[1].toLowerCase().slice(0,4)=="rgba"&&(h=aS(k[3]));k[3]&&k[3].slice(-1)=="%"&&(h/=100)}if(f[5]){k=f[5].split(aP);n=aS(k[0]);k[0].slice(-1)=="%"&&(n*=2.55);m=aS(k[1]);k[1].slice(-1)=="%"&&(m*=2.55);j=aS(k[2]);k[2].slice(-1)=="%"&&(j*=2.55);(k[0].slice(-3)=="deg"||k[0].slice(-1)=="\u00b0")&&(n/=360);f[1].toLowerCase().slice(0,4)=="hsba"&&(h=aS(k[3]));k[3]&&k[3].slice(-1)=="%"&&(h/=100);return at.hsb2rgb(n,m,j,h)}if(f[6]){k=f[6].split(aP);n=aS(k[0]);k[0].slice(-1)=="%"&&(n*=2.55);m=aS(k[1]);k[1].slice(-1)=="%"&&(m*=2.55);j=aS(k[2]);k[2].slice(-1)=="%"&&(j*=2.55);(k[0].slice(-3)=="deg"||k[0].slice(-1)=="\u00b0")&&(n/=360);f[1].toLowerCase().slice(0,4)=="hsla"&&(h=aS(k[3]));k[3]&&k[3].slice(-1)=="%"&&(h/=100);return at.hsl2rgb(n,m,j,h)}f={r:n,g:m,b:j};f.hex="#"+(16777216|j|m<<8|n<<16).toString(16).slice(1);at.is(h,"finite")&&(f.opacity=h);return f}return{r:-1,g:-1,b:-1,hex:"none",error:1}},at);at.getColor=function(f){f=this.getColor.start=this.getColor.start||{h:0,s:1,b:f||0.75};var h=this.hsb2rgb(f.h,f.s,f.b);f.h+=0.075;if(f.h>1){f.h=0;f.s-=0.2;f.s<=0&&(this.getColor.start={h:0,s:1,b:f.b})}return h.hex};at.getColor.reset=function(){delete this.start};at.parsePathString=a1(function(f){if(!f){return null}var j={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},h=[];at.is(f,aW)&&at.is(f[0],aW)&&(h=bS(f));h[aB]||aJ(f).replace(c,function(n,m,o){var k=[];n=av.call(m);o.replace(bI,function(u,s){s&&k[bv](+s)});if(n=="m"&&k[aB]>2){h[bv]([m].concat(k.splice(0,2)));n="l";m=m=="m"?"l":"L"}for(;k[aB]>=j[n];){h[bv]([m].concat(k.splice(0,j[n])));if(!j[n]){break}}});h[bD]=at._path2string;return h});at.findDotsAtSegment=function(z,x,v,o,n,s,k,j,h){var f=1-h,A=ap(f,3)*z+ap(f,2)*3*h*v+f*3*h*h*n+ap(h,3)*k;f=ap(f,3)*x+ap(f,2)*3*h*o+f*3*h*h*s+ap(h,3)*j;var y=z+2*h*(v-z)+h*h*(n-2*v+z),w=x+2*h*(o-x)+h*h*(s-2*o+x),m=v+2*h*(n-v)+h*h*(k-2*n+v),u=o+2*h*(s-o)+h*h*(j-2*s+o);z=(1-h)*z+h*v;x=(1-h)*x+h*o;n=(1-h)*n+h*k;s=(1-h)*s+h*j;j=90-bn.atan((y-m)/(w-u))*180/bl;(y>m||w<u)&&(j+=180);return{x:A,y:f,m:{x:y,y:w},n:{x:m,y:u},start:{x:z,y:x},end:{x:n,y:s},alpha:j}};var bi=a1(function(h){if(!h){return{x:0,y:0,width:0,height:0}}h=bC(h);for(var s=0,o=0,k=[],j=[],n,f=0,m=h[aB];f<m;f++){n=h[f];if(n[0]=="M"){s=n[1];o=n[2];k[bv](s);j[bv](o)}else{s=a6(s,o,n[1],n[2],n[3],n[4],n[5],n[6]);k=k.concat(s.min.x,s.max.x);j=j.concat(s.min.y,s.max.y);s=n[5];o=n[6]}}h=aE[aV](0,k);n=aE[aV](0,j);return{x:h,y:n,width:bh[aV](0,k)-h,height:bh[aV](0,j)-n}}),bS=function(f){var n=[];if(!at.is(f,aW)||!at.is(f&&f[0],aW)){f=at.parsePathString(f)}for(var m=0,j=f[aB];m<j;m++){n[m]=[];for(var h=0,k=f[m][aB];h<k;h++){n[m][h]=f[m][h]}}n[bD]=at._path2string;return n},an=a1(function(w){if(!at.is(w,aW)||!at.is(w&&w[0],aW)){w=at.parsePathString(w)}var u=[],s=0,n=0,m=0,o=0,k=0;if(w[0][0]=="M"){s=w[0][1];n=w[0][2];m=s;o=n;k++;u[bv](["M",s,n])}for(var j=w[aB];k<j;k++){var h=u[k]=[],f=w[k];if(f[0]!=av.call(f[0])){h[0]=av.call(f[0]);switch(h[0]){case"a":h[1]=f[1];h[2]=f[2];h[3]=f[3];h[4]=f[4];h[5]=f[5];h[6]=+(f[6]-s).toFixed(3);h[7]=+(f[7]-n).toFixed(3);break;case"v":h[1]=+(f[1]-n).toFixed(3);break;case"m":m=f[1];o=f[2];default:for(var x=1,v=f[aB];x<v;x++){h[x]=+(f[x]-(x%2?s:n)).toFixed(3)}}}else{u[k]=[];if(f[0]=="m"){m=f[1]+s;o=f[2]+n}h=0;for(x=f[aB];h<x;h++){u[k][h]=f[h]}}f=u[k][aB];switch(u[k][0]){case"z":s=m;n=o;break;case"h":s+=+u[k][f-1];break;case"v":n+=+u[k][f-1];break;default:s+=+u[k][f-2];n+=+u[k][f-1]}}u[bD]=at._path2string;return u},0,bS),bO=a1(function(w){if(!at.is(w,aW)||!at.is(w&&w[0],aW)){w=at.parsePathString(w)}var u=[],s=0,n=0,m=0,o=0,k=0;if(w[0][0]=="M"){s=+w[0][1];n=+w[0][2];m=s;o=n;k++;u[0]=["M",s,n]}for(var j=w[aB];k<j;k++){var h=u[k]=[],f=w[k];if(f[0]!=V.call(f[0])){h[0]=V.call(f[0]);switch(h[0]){case"A":h[1]=f[1];h[2]=f[2];h[3]=f[3];h[4]=f[4];h[5]=f[5];h[6]=+(f[6]+s);h[7]=+(f[7]+n);break;case"V":h[1]=+f[1]+n;break;case"H":h[1]=+f[1]+s;break;case"M":m=+f[1]+s;o=+f[2]+n;default:for(var x=1,v=f[aB];x<v;x++){h[x]=+f[x]+(x%2?s:n)}}}else{x=0;for(v=f[aB];x<v;x++){u[k][x]=f[x]}}switch(h[0]){case"Z":s=m;n=o;break;case"H":s=h[1];break;case"V":n=h[1];break;case"M":m=u[k][u[k][aB]-2];o=u[k][u[k][aB]-1];default:s=u[k][u[k][aB]-2];n=u[k][u[k][aB]-1]}}u[bD]=at._path2string;return u},null,bS),bu=function(h,s,o,k,j,n){var f=1/3,m=2/3;return[f*h+m*o,f*s+m*k,f*j+m*o,f*n+m*k,j,n]},aX=function(E,D,C,A,z,B,y,x,w,v){var u=bl*120/180,s=bl/180*(+z||0),o=[],k,n=a1(function(G,H,J){var F=G*bn.cos(J)-H*bn.sin(J);G=G*bn.sin(J)+H*bn.cos(J);return{x:F,y:G}});if(v){h=v[0];k=v[1];B=v[2];m=v[3]}else{k=n(E,D,-s);E=k.x;D=k.y;k=n(x,w,-s);x=k.x;w=k.y;bn.cos(bl/180*z);bn.sin(bl/180*z);k=(E-x)/2;h=(D-w)/2;m=k*k/(C*C)+h*h/(A*A);if(m>1){m=bn.sqrt(m);C*=m;A*=m}m=C*C;var j=A*A;m=(B==y?-1:1)*bn.sqrt(ax((m*j-m*h*h-j*k*k)/(m*h*h+j*k*k)));B=m*C*h/A+(E+x)/2;var m=m*-A*k/C+(D+w)/2,h=bn.asin(((D-m)/A).toFixed(9));k=bn.asin(((w-m)/A).toFixed(9));h=E<B?bl-h:h;k=x<B?bl-k:k;h<0&&(h=bl*2+h);k<0&&(k=bl*2+k);y&&h>k&&(h-=bl*2);!y&&k>h&&(k-=bl*2)}if(ax(k-h)>u){o=k;j=x;var f=w;k=h+u*(y&&k>h?1:-1);x=B+C*bn.cos(k);w=m+A*bn.sin(k);o=aX(x,w,C,A,z,0,y,j,f,[k,o,B,m])}B=k-h;z=bn.cos(h);u=bn.sin(h);y=bn.cos(k);k=bn.sin(k);B=bn.tan(B/4);C=4/3*C*B;B*=4/3*A;A=[E,D];E=[E+C*u,D-B*z];D=[x+C*k,w-B*y];x=[x,w];E[0]=2*A[0]-E[0];E[1]=2*A[1]-E[1];if(v){return[E,D,x].concat(o)}o=[E,D,x].concat(o)[au]().split(",");v=[];x=0;for(w=o[aB];x<w;x++){v[x]=x%2?n(o[x-1],o[x],s).y:n(o[x],o[x+1],s).x}return v},aM=function(v,u,s,n,m,o,k,j,h){var f=1-h;return{x:ap(f,3)*v+ap(f,2)*3*h*s+f*3*h*h*m+ap(h,3)*k,y:ap(f,3)*u+ap(f,2)*3*h*n+f*3*h*h*o+ap(h,3)*j}},a6=a1(function(y,w,u,o,n,s,k,j){var h=n-2*u+y-(k-2*n+u),f=2*(u-y)-2*(n-u),z=y-u,x=(-f+bn.sqrt(f*f-4*h*z))/2/h;h=(-f-bn.sqrt(f*f-4*h*z))/2/h;var v=[w,j],m=[y,k];ax(x)>"1e12"&&(x=0.5);ax(h)>"1e12"&&(h=0.5);if(x>0&&x<1){x=aM(y,w,u,o,n,s,k,j,x);m[bv](x.x);v[bv](x.y)}if(h>0&&h<1){x=aM(y,w,u,o,n,s,k,j,h);m[bv](x.x);v[bv](x.y)}h=s-2*o+w-(j-2*s+o);f=2*(o-w)-2*(s-o);z=w-o;x=(-f+bn.sqrt(f*f-4*h*z))/2/h;h=(-f-bn.sqrt(f*f-4*h*z))/2/h;ax(x)>"1e12"&&(x=0.5);ax(h)>"1e12"&&(h=0.5);if(x>0&&x<1){x=aM(y,w,u,o,n,s,k,j,x);m[bv](x.x);v[bv](x.y)}if(h>0&&h<1){x=aM(y,w,u,o,n,s,k,j,h);m[bv](x.x);v[bv](x.y)}return{min:{x:aE[aV](0,m),y:aE[aV](0,v)},max:{x:bh[aV](0,m),y:bh[aV](0,v)}}}),bC=a1(function(z,x){var v=bO(z),o=x&&bO(x),n={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},k=function(B,D){var E,C;if(!B){return["C",D.x,D.y,D.x,D.y,D.x,D.y]}!(B[0] in {T:1,Q:1})&&(D.qx=D.qy=null);switch(B[0]){case"M":D.X=B[1];D.Y=B[2];break;case"A":B=["C"].concat(aX[aV](0,[D.x,D.y].concat(B.slice(1))));break;case"S":E=D.x+(D.x-(D.bx||D.x));C=D.y+(D.y-(D.by||D.y));B=["C",E,C].concat(B.slice(1));break;case"T":D.qx=D.x+(D.x-(D.qx||D.x));D.qy=D.y+(D.y-(D.qy||D.y));B=["C"].concat(bu(D.x,D.y,D.qx,D.qy,B[1],B[2]));break;case"Q":D.qx=B[1];D.qy=B[2];B=["C"].concat(bu(D.x,D.y,B[1],B[2],B[3],B[4]));break;case"L":B=["C"].concat([D.x,D.y,B[1],B[2],B[1],B[2]]);break;case"H":B=["C"].concat([D.x,D.y,B[1],D.y,B[1],D.y]);break;case"V":B=["C"].concat([D.x,D.y,D.x,B[1],D.x,B[1]]);break;case"Z":B=["C"].concat([D.x,D.y,D.X,D.Y,D.X,D.Y])}return B},j=function(B,C){if(B[C][aB]>7){B[C].shift();for(var D=B[C];D[aB];){B.splice(C++,0,["C"].concat(D.splice(0,6)))}B.splice(C,1);A=bh(v[aB],o&&o[aB]||0)}},h=function(B,E,F,D,C){if(B&&E&&B[C][0]=="M"&&E[C][0]!="M"){E.splice(C,0,["M",D.x,D.y]);F.bx=0;F.by=0;F.x=B[C][1];F.y=B[C][2];A=bh(v[aB],o&&o[aB]||0)}},f=0,A=bh(v[aB],o&&o[aB]||0);for(;f<A;f++){v[f]=k(v[f],n);j(v,f);o&&(o[f]=k(o[f],s));o&&j(o,f);h(v,o,n,s,f);h(o,v,s,n,f);var y=v[f],w=o&&o[f],m=y[aB],u=o&&w[aB];n.x=y[m-2];n.y=y[m-1];n.bx=aS(y[m-4])||n.x;n.by=aS(y[m-3])||n.y;s.bx=o&&(aS(w[u-4])||s.x);s.by=o&&(aS(w[u-3])||s.y);s.x=o&&w[u-2];s.y=o&&w[u-1]}return o?[v,o]:v},null,bS),ay=a1(function(f){for(var n=[],m=0,j=f[aB];m<j;m++){var h={},k=f[m].match(/^([^:]*):?([\d\.]*)/);h.color=at.getRGB(k[1]);if(h.color.error){return null}h.color=h.color.hex;k[2]&&(h.offset=k[2]+"%");n[bv](h)}m=1;for(j=n[aB]-1;m<j;m++){if(!n[m].offset){f=aS(n[m-1].offset||0);k=0;for(h=m+1;h<j;h++){if(n[h].offset){k=n[h].offset;break}}if(!k){k=100;h=j}k=aS(k);for(k=(k-f)/(h-m+1);m<h;m++){f+=k;n[m].offset=f+"%"}}}return n}),ad=function(f,k,j,h){if(at.is(f,"string")||at.is(f,"object")){f=at.is(f,"string")?aC.getElementById(f):f;if(f.tagName){return k==null?{container:f,width:f.style.pixelWidth||f.offsetWidth,height:f.style.pixelHeight||f.offsetHeight}:{container:f,width:k,height:j}}}else{return{container:1,x:f,y:k,width:j,height:h}}},Y=function(f,k){var j=this,h;for(h in k){if(k[aI](h)&&!(h in f)){switch(typeof k[h]){case"function":(function(m){f[h]=f===j?m:function(){return m[aV](j,arguments)}})(k[h]);break;case"object":f[h]=f[h]||{};Y.call(this,f[h],k[h]);break;default:f[h]=k[h]}}}},bs=function(f,h){f==h.top&&(h.top=f.prev);f==h.bottom&&(h.bottom=f.next);f.next&&(f.next.prev=f.prev);f.prev&&(f.prev.next=f.next)},i=function(f,h){if(h.top!==f){bs(f,h);f.next=null;f.prev=h.top;h.top.next=f;h.top=f}},bL=function(f,h){if(h.bottom!==f){bs(f,h);f.next=h.bottom;f.prev=null;h.bottom.prev=f;h.bottom=f}},bw=function(f,j,h){bs(f,h);j==h.top&&(h.top=f);j.next&&(j.next.prev=f);f.next=j.next;f.prev=j;j.next=f},a3=function(f,j,h){bs(f,h);j==h.bottom&&(h.bottom=f);j.prev&&(j.prev.next=f);f.prev=j.prev;j.prev=f;f.next=j},aD=function(f){return function(){throw Error("Rapha\u00ebl: you are calling to method \u201c"+f+"\u201d of removed object")}};at.pathToRelative=an;if(at.svg){a0.svgns="http://www.w3.org/2000/svg";a0.xlink="http://www.w3.org/1999/xlink";aZ=function(f){return +f+(~~f===f)*0.5};var az=function(f,j){if(j){for(var h in j){j[aI](h)&&f.setAttribute(h,aJ(j[h]))}}else{f=aC.createElementNS(a0.svgns,f);f.style.webkitTapHighlightColor="rgba(0,0,0,0)";return f}};at[bD]=function(){return"Your browser supports SVG.\nYou are running Rapha\u00ebl "+this.version};var af=function(f,j){var h=az("path");j.canvas&&j.canvas.appendChild(h);h=new aF(h,j);h.type="path";d(h,{fill:"none",stroke:"#000",path:f});return h},bz=function(v,u,s){var n="linear",m=0.5,o=0.5,k=v.style;u=aJ(u).replace(bK,function(y,x,w){n="radial";if(x&&w){m=aS(x);o=aS(w);y=(o>0.5)*2-1;ap(m-0.5,2)+ap(o-0.5,2)>0.25&&(o=bn.sqrt(0.25-ap(m-0.5,2))*y+0.5)&&o!=0.5&&(o=o.toFixed(5)-0.00001*y)}return""});u=u.split(/\s*\-\s*/);if(n=="linear"){var j=u.shift();j=-aS(j);if(isNaN(j)){return null}j=[0,0,bn.cos(j*bl/180),bn.sin(j*bl/180)];var h=1/(bh(ax(j[2]),ax(j[3]))||1);j[2]*=h;j[3]*=h;if(j[2]<0){j[0]=-j[2];j[2]=0}if(j[3]<0){j[1]=-j[3];j[3]=0}}u=ay(u);if(!u){return null}h=v.getAttribute("fill");(h=h.match(/^url\(#(.*)\)$/))&&s.defs.removeChild(aC.getElementById(h[1]));h=az(n+"Gradient");h.id=aQ();az(h,n=="radial"?{fx:m,fy:o}:{x1:j[0],y1:j[1],x2:j[2],y2:j[3]});s.defs.appendChild(h);s=0;for(j=u[aB];s<j;s++){var f=az("stop");az(f,{offset:u[s].offset?u[s].offset:s?"100%":"0%","stop-color":u[s].color||"#fff"});h.appendChild(f)}az(v,{fill:"url(#"+h.id+")",opacity:1,"fill-opacity":1});k.fill="";k.opacity=1;return k.fillOpacity=1},e=function(f){var h=f.getBBox();az(f.pattern,{patternTransform:at.format("translate({0},{1})",h.x,h.y)})},d=function(y,w){var u={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},o=y.node,n=y.attrs,s=y.rotate(),k=function(D,A){if(A=u[av.call(A)]){for(var E=D.attrs["stroke-width"]||"1",F={round:E,square:E,butt:0}[D.attrs["stroke-linecap"]||w["stroke-linecap"]]||0,C=[],B=A[aB];B--;){C[B]=A[B]*E+(B%2?1:-1)*F}az(o,{"stroke-dasharray":C[au](",")})}};w[aI]("rotation")&&(s=w.rotation);var j=aJ(s).split(bf);if(j.length-1){j[1]=+j[1];j[2]=+j[2]}else{j=null}aS(s)&&y.rotate(0,true);for(var h in w){if(w[aI](h)){if(ah[aI](h)){var f=w[h];n[h]=f;switch(h){case"blur":y.blur(f);break;case"rotation":y.rotate(f,true);break;case"href":case"title":case"target":var z=o.parentNode;if(av.call(z.tagName)!="a"){var x=az("a");z.insertBefore(x,o);x.appendChild(o);z=x}h=="target"&&f=="blank"?z.setAttributeNS(y.paper.xlink,"show","new"):z.setAttributeNS(y.paper.xlink,h,f);break;case"cursor":o.style.cursor=f;break;case"clip-rect":z=aJ(f).split(bf);if(z[aB]==4){y.clip&&y.clip.parentNode.parentNode.removeChild(y.clip.parentNode);var v=az("clipPath");x=az("rect");v.id=aQ();az(x,{x:z[0],y:z[1],width:z[2],height:z[3]});v.appendChild(x);y.paper.defs.appendChild(v);az(o,{"clip-path":"url(#"+v.id+")"});y.clip=x}if(!f){(f=aC.getElementById(o.getAttribute("clip-path").replace(/(^url\(#|\)$)/g,"")))&&f.parentNode.removeChild(f);az(o,{"clip-path":""});delete y.clip}break;case"path":y.type=="path"&&az(o,{d:f?n.path=bO(f):"M0,0"});break;case"width":o.setAttribute(h,f);if(n.fx){h="x";f=n.x}else{break}case"x":n.fx&&(f=-n.x-(n.width||0));case"rx":if(h=="rx"&&y.type=="rect"){break}case"cx":j&&(h=="x"||h=="cx")&&(j[1]+=f-n[h]);o.setAttribute(h,f);y.pattern&&e(y);break;case"height":o.setAttribute(h,f);if(n.fy){h="y";f=n.y}else{break}case"y":n.fy&&(f=-n.y-(n.height||0));case"ry":if(h=="ry"&&y.type=="rect"){break}case"cy":j&&(h=="y"||h=="cy")&&(j[2]+=f-n[h]);o.setAttribute(h,f);y.pattern&&e(y);break;case"r":y.type=="rect"?az(o,{rx:f,ry:f}):o.setAttribute(h,f);break;case"src":y.type=="image"&&o.setAttributeNS(y.paper.xlink,"href",f);break;case"stroke-width":o.style.strokeWidth=f;o.setAttribute(h,f);n["stroke-dasharray"]&&k(y,n["stroke-dasharray"]);break;case"stroke-dasharray":k(y,f);break;case"translation":f=aJ(f).split(bf);f[0]=+f[0]||0;f[1]=+f[1]||0;if(j){j[1]+=f[0];j[2]+=f[1]}ak.call(y,f[0],f[1]);break;case"scale":f=aJ(f).split(bf);y.scale(+f[0]||1,+f[1]||+f[0]||1,isNaN(aS(f[2]))?null:+f[2],isNaN(aS(f[3]))?null:+f[3]);break;case"fill":if(z=aJ(f).match(bN)){v=az("pattern");var m=az("image");v.id=aQ();az(v,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});az(m,{x:0,y:0});m.setAttributeNS(y.paper.xlink,"href",z[1]);v.appendChild(m);f=aC.createElement("img");f.style.cssText="position:absolute;left:-9999em;top-9999em";f.onload=function(){az(v,{width:this.offsetWidth,height:this.offsetHeight});az(m,{width:this.offsetWidth,height:this.offsetHeight});aC.body.removeChild(this);y.paper.safari()};aC.body.appendChild(f);f.src=z[1];y.paper.defs.appendChild(v);o.style.fill="url(#"+v.id+")";az(o,{fill:"url(#"+v.id+")"});y.pattern=v;y.pattern&&e(y);break}z=at.getRGB(f);if(z.error){if(({circle:1,ellipse:1}[aI](y.type)||aJ(f).charAt()!="r")&&bz(o,f,y.paper)){n.gradient=f;n.fill="none";break}else{delete w.gradient;delete n.gradient;!at.is(n.opacity,"undefined")&&at.is(w.opacity,"undefined")&&az(o,{opacity:n.opacity});!at.is(n["fill-opacity"],"undefined")&&at.is(w["fill-opacity"],"undefined")&&az(o,{"fill-opacity":n["fill-opacity"]})}}z[aI]("opacity")&&az(o,{"fill-opacity":z.opacity>1?z.opacity/100:z.opacity});case"stroke":z=at.getRGB(f);o.setAttribute(h,z.hex);h=="stroke"&&z[aI]("opacity")&&az(o,{"stroke-opacity":z.opacity>1?z.opacity/100:z.opacity});break;case"gradient":(({circle:1,ellipse:1})[aI](y.type)||aJ(f).charAt()!="r")&&bz(o,f,y.paper);break;case"opacity":n.gradient&&!n[aI]("stroke-opacity")&&az(o,{"stroke-opacity":f>1?f/100:f});case"fill-opacity":if(n.gradient){if(z=aC.getElementById(o.getAttribute("fill").replace(/^url\(#|\)$/g,""))){z=z.getElementsByTagName("stop");z[z[aB]-1].setAttribute("stop-opacity",f)}break}default:h=="font-size"&&(f=bg(f,10)+"px");z=h.replace(/(\-.)/g,function(A){return V.call(A.substring(1))});o.style[z]=f;o.setAttribute(h,f)}}}}aG(y,w);j?y.rotate(j.join(aT)):aS(s)&&y.rotate(s,true)},aG=function(u,s){if(!(u.type!="text"||!(s[aI]("text")||s[aI]("font")||s[aI]("font-size")||s[aI]("x")||s[aI]("y")))){var o=u.attrs,m=u.node,k=m.firstChild?bg(aC.defaultView.getComputedStyle(m.firstChild,"").getPropertyValue("font-size"),10):10;if(s[aI]("text")){for(o.text=s.text;m.firstChild;){m.removeChild(m.firstChild)}for(var n=aJ(s.text).split("\n"),j=0,h=n[aB];j<h;j++){if(n[j]){var f=az("tspan");j&&az(f,{dy:k*1.2,x:o.x});f.appendChild(aC.createTextNode(n[j]));m.appendChild(f)}}}else{n=m.getElementsByTagName("tspan");j=0;for(h=n[aB];j<h;j++){j&&az(n[j],{dy:k*1.2,x:o.x})}}az(m,{y:o.y});k=u.getBBox();(k=o.y-(k.y+k.height/2))&&at.is(k,"finite")&&az(m,{y:o.y+k})}},aF=function(f,h){this[0]=f;this.id=at._oid++;this.node=f;f.raphael=this;this.paper=h;this.attrs=this.attrs||{};this.transformations=[];this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1};!h.bottom&&(h.bottom=this);(this.prev=h.top)&&(h.top.next=this);h.top=this;this.next=null},a4=aF[a8];aF[a8].rotate=function(f,k,j){if(this.removed){return this}if(f==null){if(this._.rt.cx){return[this._.rt.deg,this._.rt.cx,this._.rt.cy][au](aT)}return this._.rt.deg}var h=this.getBBox();f=aJ(f).split(bf);if(f[aB]-1){k=aS(f[1]);j=aS(f[2])}f=aS(f[0]);k!=null&&k!==false?this._.rt.deg=f:this._.rt.deg+=f;j==null&&(k=null);this._.rt.cx=k;this._.rt.cy=j;k=k==null?h.x+h.width/2:k;j=j==null?h.y+h.height/2:j;if(this._.rt.deg){this.transformations[0]=at.format("rotate({0} {1} {2})",this._.rt.deg,k,j);this.clip&&az(this.clip,{transform:at.format("rotate({0} {1} {2})",-this._.rt.deg,k,j)})}else{this.transformations[0]="";this.clip&&az(this.clip,{transform:""})}az(this.node,{transform:this.transformations[au](aT)});return this};aF[a8].hide=function(){!this.removed&&(this.node.style.display="none");return this};aF[a8].show=function(){!this.removed&&(this.node.style.display="");return this};aF[a8].remove=function(){if(!this.removed){bs(this,this.paper);this.node.parentNode.removeChild(this.node);for(var f in this){delete this[f]}this.removed=true}};aF[a8].getBBox=function(){if(this.removed){return this}if(this.type=="path"){return bi(this.attrs.path)}if(this.node.style.display=="none"){this.show();var f=true}var n={};try{n=this.node.getBBox()}catch(m){}finally{n=n||{}}if(this.type=="text"){n={x:n.x,y:Infinity,width:0,height:0};for(var j=0,h=this.node.getNumberOfChars();j<h;j++){var k=this.node.getExtentOfChar(j);k.y<n.y&&(n.y=k.y);k.y+k.height-n.y>n.height&&(n.height=k.y+k.height-n.y);k.x+k.width-n.x>n.width&&(n.width=k.x+k.width-n.x)}}f&&this.hide();return n};aF[a8].attr=function(f,n){if(this.removed){return this}if(f==null){var m={},j;for(j in this.attrs){this.attrs[aI](j)&&(m[j]=this.attrs[j])}this._.rt.deg&&(m.rotation=this.rotate());(this._.sx!=1||this._.sy!=1)&&(m.scale=this.scale());m.gradient&&m.fill=="none"&&(m.fill=m.gradient)&&delete m.gradient;return m}if(n==null&&at.is(f,"string")){if(f=="translation"){return ak.call(this)}if(f=="rotation"){return this.rotate()}if(f=="scale"){return this.scale()}if(f=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}return this.attrs[f]}if(n==null&&at.is(f,aW)){j={};m=0;for(var h=f.length;m<h;m++){j[f[m]]=this.attr(f[m])}return j}if(n!=null){m={};m[f]=n}else{f!=null&&at.is(f,"object")&&(m=f)}for(h in this.paper.customAttributes){if(this.paper.customAttributes[aI](h)&&m[aI](h)&&at.is(this.paper.customAttributes[h],"function")){j=this.paper.customAttributes[h].apply(this,[].concat(m[h]));this.attrs[h]=m[h];for(var k in j){j[aI](k)&&(m[k]=j[k])}}}d(this,m);return this};aF[a8].toFront=function(){if(this.removed){return this}this.node.parentNode.appendChild(this.node);var f=this.paper;f.top!=this&&i(this,f);return this};aF[a8].toBack=function(){if(this.removed){return this}if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild);bL(this,this.paper)}return this};aF[a8].insertAfter=function(f){if(this.removed){return this}var h=f.node||f[f.length-1].node;h.nextSibling?h.parentNode.insertBefore(this.node,h.nextSibling):h.parentNode.appendChild(this.node);bw(this,f,this.paper);return this};aF[a8].insertBefore=function(f){if(this.removed){return this}var h=f.node||f[0].node;h.parentNode.insertBefore(this.node,h);a3(this,f,this.paper);return this};aF[a8].blur=function(f){if(+f!==0){var j=az("filter"),h=az("feGaussianBlur");this.attrs.blur=f;j.id=aQ();az(h,{stdDeviation:+f||1.5});j.appendChild(h);this.paper.defs.appendChild(j);this._blur=j;az(this.node,{filter:"url(#"+j.id+")"})}else{if(this._blur){this._blur.parentNode.removeChild(this._blur);delete this._blur;delete this.attrs.blur}this.node.removeAttribute("filter")}};var l=function(f,m,k,j){var h=az("circle");f.canvas&&f.canvas.appendChild(h);f=new aF(h,f);f.attrs={cx:m,cy:k,r:j,fill:"none",stroke:"#000"};f.type="circle";az(h,f.attrs);return f},bP=function(h,o,n,k,j,m){var f=az("rect");h.canvas&&h.canvas.appendChild(f);h=new aF(f,h);h.attrs={x:o,y:n,width:k,height:j,r:m||0,rx:m||0,ry:m||0,fill:"none",stroke:"#000"};h.type="rect";az(f,h.attrs);return h},bA=function(f,n,m,j,h){var k=az("ellipse");f.canvas&&f.canvas.appendChild(k);f=new aF(k,f);f.attrs={cx:n,cy:m,rx:j,ry:h,fill:"none",stroke:"#000"};f.type="ellipse";az(k,f.attrs);return f},bc=function(h,o,n,k,j,m){var f=az("image");az(f,{x:n,y:k,width:j,height:m,preserveAspectRatio:"none"});f.setAttributeNS(h.xlink,"href",o);h.canvas&&h.canvas.appendChild(f);h=new aF(f,h);h.attrs={x:n,y:k,width:j,height:m,src:o};h.type="image";return h},aK=function(f,m,k,j){var h=az("text");az(h,{x:m,y:k,"text-anchor":"middle"});f.canvas&&f.canvas.appendChild(h);f=new aF(h,f);f.attrs={x:m,y:k,"text-anchor":"middle",text:j,font:ah.font,stroke:"none",fill:"#000"};f.type="text";d(f,f.attrs);return f},ai=function(f,h){this.width=f||this.width;this.height=h||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);return this},bH=function(){var f=ad[aV](0,arguments),n=f&&f.container,m=f.x,j=f.y,h=f.width;f=f.height;if(!n){throw Error("SVG container not found.")}var k=az("svg");m=m||0;j=j||0;h=h||512;f=f||342;az(k,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:h,height:f});if(n==1){k.style.cssText="position:absolute;left:"+m+"px;top:"+j+"px";aC.body.appendChild(k)}else{n.firstChild?n.insertBefore(k,n.firstChild):n.appendChild(k)}n=new bd;n.width=h;n.height=f;n.canvas=k;Y.call(n,n,at.fn);n.clear();return n};a0.clear=function(){for(var f=this.canvas;f.firstChild;){f.removeChild(f.firstChild)}this.bottom=this.top=null;(this.desc=az("desc")).appendChild(aC.createTextNode("Created with Rapha\u00ebl"));f.appendChild(this.desc);f.appendChild(this.defs=az("defs"))};a0.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var f in this){this[f]=aD(f)}}}if(at.vml){var I={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},ag=/([clmz]),?([^clmz]*)/gi,p=/ progid:\S+Blur\([^\)]+\)/g,bQ=/-?[^,\s-]+/g,a7=1000+aT+1000,aH={path:1,rect:1},bB=function(h){var s=/[ahqstv]/ig,o=bO;aJ(h).match(s)&&(o=bC);s=/[clmz]/g;if(o==bO&&!aJ(h).match(s)){return h=aJ(h).replace(ag,function(z,y,x){var v=[],u=av.call(y)=="m",w=I[y];x.replace(bQ,function(A){if(u&&v[aB]==2){w+=v+I[y=="m"?"l":"L"];v=[]}v[bv](aZ(A*10))});return w+v})}s=o(h);var k;h=[];for(var j=0,n=s[aB];j<n;j++){o=s[j];k=av.call(s[j][0]);k=="z"&&(k="x");for(var f=1,m=o[aB];f<m;f++){k+=aZ(o[f]*10)+(f!=m-1?",":"")}h[bv](k)}return h[au](aT)};at[bD]=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\u00ebl "+this.version};af=function(f,m){var k=L("group");k.style.cssText="position:absolute;left:0;top:0;width:"+m.width+"px;height:"+m.height+"px";k.coordsize=m.coordsize;k.coordorigin=m.coordorigin;var j=L("shape"),h=j.style;h.width=m.width+"px";h.height=m.height+"px";j.coordsize=a7;j.coordorigin=m.coordorigin;k.appendChild(j);j=new aF(j,k,m);h={fill:"none",stroke:"#000"};f&&(h.path=f);j.type="path";j.path=[];j.Path="";d(j,h);m.canvas.appendChild(k);return j};d=function(u,s){u.attrs=u.attrs||{};var o=u.node,m=u.attrs,k=o.style,n;n=(s.x!=m.x||s.y!=m.y||s.width!=m.width||s.height!=m.height||s.r!=m.r)&&u.type=="rect";for(var j in s){s[aI](j)&&(m[j]=s[j])}if(n){m.path=bT(m.x,m.y,m.width,m.height,m.r);u.X=m.x;u.Y=m.y;u.W=m.width;u.H=m.height}s.href&&(o.href=s.href);s.title&&(o.title=s.title);s.target&&(o.target=s.target);s.cursor&&(k.cursor=s.cursor);"blur" in s&&u.blur(s.blur);if(s.path&&u.type=="path"||n){o.path=bB(m.path)}s.rotation!=null&&u.rotate(s.rotation,true);if(s.translation){n=aJ(s.translation).split(bf);ak.call(u,n[0],n[1]);if(u._.rt.cx!=null){u._.rt.cx+=+n[0];u._.rt.cy+=+n[1];u.setBox(u.attrs,n[0],n[1])}}if(s.scale){n=aJ(s.scale).split(bf);u.scale(+n[0]||1,+n[1]||+n[0]||1,+n[2]||null,+n[3]||null)}if("clip-rect" in s){n=aJ(s["clip-rect"]).split(bf);if(n[aB]==4){n[2]=+n[2]+ +n[0];n[3]=+n[3]+ +n[1];j=o.clipRect||aC.createElement("div");var h=j.style,f=o.parentNode;h.clip=at.format("rect({1}px {2}px {3}px {0}px)",n);if(!o.clipRect){h.position="absolute";h.top=0;h.left=0;h.width=u.paper.width+"px";h.height=u.paper.height+"px";f.parentNode.insertBefore(j,f);j.appendChild(f);o.clipRect=j}}s["clip-rect"]||o.clipRect&&(o.clipRect.style.clip="")}u.type=="image"&&s.src&&(o.src=s.src);if(u.type=="image"&&s.opacity){o.filterOpacity=" progid:DXImageTransform.Microsoft.Alpha(opacity="+s.opacity*100+")";k.filter=(o.filterMatrix||"")+(o.filterOpacity||"")}s.font&&(k.font=s.font);s["font-family"]&&(k.fontFamily='"'+s["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,"")+'"');s["font-size"]&&(k.fontSize=s["font-size"]);s["font-weight"]&&(k.fontWeight=s["font-weight"]);s["font-style"]&&(k.fontStyle=s["font-style"]);if(s.opacity!=null||s["stroke-width"]!=null||s.fill!=null||s.stroke!=null||s["stroke-width"]!=null||s["stroke-opacity"]!=null||s["fill-opacity"]!=null||s["stroke-dasharray"]!=null||s["stroke-miterlimit"]!=null||s["stroke-linejoin"]!=null||s["stroke-linecap"]!=null){o=u.shape||o;n=o.getElementsByTagName("fill")&&o.getElementsByTagName("fill")[0];j=false;!n&&(j=n=L("fill"));if("fill-opacity" in s||"opacity" in s){k=((+m["fill-opacity"]+1||2)-1)*((+m.opacity+1||2)-1)*((+at.getRGB(s.fill).o+1||2)-1);k=aE(bh(k,0),1);n.opacity=k}s.fill&&(n.on=true);if(n.on==null||s.fill=="none"){n.on=false}if(n.on&&s.fill){if(k=s.fill.match(bN)){n.src=k[1];n.type="tile"}else{n.color=at.getRGB(s.fill).hex;n.src="";n.type="solid";if(at.getRGB(s.fill).error&&(u.type in {circle:1,ellipse:1}||aJ(s.fill).charAt()!="r")&&bz(u,s.fill)){m.fill="none";m.gradient=s.fill}}}j&&o.appendChild(n);n=o.getElementsByTagName("stroke")&&o.getElementsByTagName("stroke")[0];j=false;!n&&(j=n=L("stroke"));if(s.stroke&&s.stroke!="none"||s["stroke-width"]||s["stroke-opacity"]!=null||s["stroke-dasharray"]||s["stroke-miterlimit"]||s["stroke-linejoin"]||s["stroke-linecap"]){n.on=true}(s.stroke=="none"||n.on==null||s.stroke==0||s["stroke-width"]==0)&&(n.on=false);k=at.getRGB(s.stroke);n.on&&s.stroke&&(n.color=k.hex);k=((+m["stroke-opacity"]+1||2)-1)*((+m.opacity+1||2)-1)*((+k.o+1||2)-1);h=(aS(s["stroke-width"])||1)*0.75;k=aE(bh(k,0),1);s["stroke-width"]==null&&(h=m["stroke-width"]);s["stroke-width"]&&(n.weight=h);h&&h<1&&(k*=h)&&(n.weight=1);n.opacity=k;s["stroke-linejoin"]&&(n.joinstyle=s["stroke-linejoin"]||"miter");n.miterlimit=s["stroke-miterlimit"]||8;s["stroke-linecap"]&&(n.endcap=s["stroke-linecap"]=="butt"?"flat":s["stroke-linecap"]=="square"?"square":"round");if(s["stroke-dasharray"]){k={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};n.dashstyle=k[aI](s["stroke-dasharray"])?k[s["stroke-dasharray"]]:""}j&&o.appendChild(n)}if(u.type=="text"){k=u.paper.span.style;m.font&&(k.font=m.font);m["font-family"]&&(k.fontFamily=m["font-family"]);m["font-size"]&&(k.fontSize=m["font-size"]);m["font-weight"]&&(k.fontWeight=m["font-weight"]);m["font-style"]&&(k.fontStyle=m["font-style"]);u.node.string&&(u.paper.span.innerHTML=aJ(u.node.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));u.W=m.w=u.paper.span.offsetWidth;u.H=m.h=u.paper.span.offsetHeight;u.X=m.x;u.Y=m.y+aZ(u.H/2);switch(m["text-anchor"]){case"start":u.node.style["v-text-align"]="left";u.bbx=aZ(u.W/2);break;case"end":u.node.style["v-text-align"]="right";u.bbx=-aZ(u.W/2);break;default:u.node.style["v-text-align"]="center"}}};bz=function(v,u){v.attrs=v.attrs||{};var s,n="linear",m=".5 .5";v.attrs.gradient=u;u=aJ(u).replace(bK,function(y,x,w){n="radial";if(x&&w){x=aS(x);w=aS(w);ap(x-0.5,2)+ap(w-0.5,2)>0.25&&(w=bn.sqrt(0.25-ap(x-0.5,2))*((w>0.5)*2-1)+0.5);m=x+aT+w}return""});u=u.split(/\s*\-\s*/);if(n=="linear"){var o=u.shift();o=-aS(o);if(isNaN(o)){return null}}var k=ay(u);if(!k){return null}v=v.shape||v.node;s=v.getElementsByTagName("fill")[0]||L("fill");!s.parentNode&&v.appendChild(s);if(k[aB]){s.on=true;s.method="none";s.color=k[0].color;s.color2=k[k[aB]-1].color;for(var j=[],h=0,f=k[aB];h<f;h++){k[h].offset&&j[bv](k[h].offset+aT+k[h].color)}s.colors&&(s.colors.value=j[aB]?j[au]():"0% "+s.color);if(n=="radial"){s.type="gradientradial";s.focus="100%";s.focussize=m;s.focusposition=m}else{s.type="gradient";s.angle=(270-o)%360}}return 1};aF=function(f,j,h){this[0]=f;this.id=at._oid++;this.node=f;f.raphael=this;this.Y=this.X=0;this.attrs={};this.Group=j;this.paper=h;this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1};!h.bottom&&(h.bottom=this);(this.prev=h.top)&&(h.top.next=this);h.top=this;this.next=null};a4=aF[a8];a4.rotate=function(f,j,h){if(this.removed){return this}if(f==null){if(this._.rt.cx){return[this._.rt.deg,this._.rt.cx,this._.rt.cy][au](aT)}return this._.rt.deg}f=aJ(f).split(bf);if(f[aB]-1){j=aS(f[1]);h=aS(f[2])}f=aS(f[0]);j!=null?this._.rt.deg=f:this._.rt.deg+=f;h==null&&(j=null);this._.rt.cx=j;this._.rt.cy=h;this.setBox(this.attrs,j,h);this.Group.style.rotation=this._.rt.deg;return this};a4.setBox=function(u,s,o){if(this.removed){return this}var m=this.Group.style,k=this.shape&&this.shape.style||this.node.style;u=u||{};for(var n in u){u[aI](n)&&(this.attrs[n]=u[n])}s=s||this._.rt.cx;o=o||this._.rt.cy;var j=this.attrs,h;switch(this.type){case"circle":u=j.cx-j.r;n=j.cy-j.r;h=j=j.r*2;break;case"ellipse":u=j.cx-j.rx;n=j.cy-j.ry;h=j.rx*2;j=j.ry*2;break;case"image":u=+j.x;n=+j.y;h=j.width||0;j=j.height||0;break;case"text":this.textpath.v=["m",aZ(j.x),", ",aZ(j.y-2),"l",aZ(j.x)+1,", ",aZ(j.y-2)][au]("");u=j.x-aZ(this.W/2);n=j.y-this.H/2;h=this.W;j=this.H;break;case"rect":case"path":if(this.attrs.path){j=bi(this.attrs.path);u=j.x;n=j.y;h=j.width;j=j.height}else{n=u=0;h=this.paper.width;j=this.paper.height}break;default:n=u=0;h=this.paper.width;j=this.paper.height}s=(s==null?u+h/2:s)-this.paper.width/2;o=(o==null?n+j/2:o)-this.paper.height/2;var f;m.left!=(f=s+"px")&&(m.left=f);m.top!=(f=o+"px")&&(m.top=f);this.X=aH[aI](this.type)?-s:u;this.Y=aH[aI](this.type)?-o:n;this.W=h;this.H=j;if(aH[aI](this.type)){k.left!=(f=-s*10+"px")&&(k.left=f);k.top!=(f=-o*10+"px")&&(k.top=f)}else{if(this.type=="text"){k.left!=(f=-s+"px")&&(k.left=f);k.top!=(f=-o+"px")&&(k.top=f)}else{m.width!=(f=this.paper.width+"px")&&(m.width=f);m.height!=(f=this.paper.height+"px")&&(m.height=f);k.left!=(f=u-s+"px")&&(k.left=f);k.top!=(f=n-o+"px")&&(k.top=f);k.width!=(f=h+"px")&&(k.width=f);k.height!=(f=j+"px")&&(k.height=f)}}};a4.hide=function(){!this.removed&&(this.Group.style.display="none");return this};a4.show=function(){!this.removed&&(this.Group.style.display="block");return this};a4.getBBox=function(){if(this.removed){return this}if(aH[aI](this.type)){return bi(this.attrs.path)}return{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}};a4.remove=function(){if(!this.removed){bs(this,this.paper);this.node.parentNode.removeChild(this.node);this.Group.parentNode.removeChild(this.Group);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var f in this){delete this[f]}this.removed=true}};a4.attr=function(f,n){if(this.removed){return this}if(f==null){var m={},j;for(j in this.attrs){this.attrs[aI](j)&&(m[j]=this.attrs[j])}this._.rt.deg&&(m.rotation=this.rotate());(this._.sx!=1||this._.sy!=1)&&(m.scale=this.scale());m.gradient&&m.fill=="none"&&(m.fill=m.gradient)&&delete m.gradient;return m}if(n==null&&at.is(f,"string")){if(f=="translation"){return ak.call(this)}if(f=="rotation"){return this.rotate()}if(f=="scale"){return this.scale()}if(f=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}return this.attrs[f]}if(this.attrs&&n==null&&at.is(f,aW)){var h={};j=0;for(m=f[aB];j<m;j++){h[f[j]]=this.attr(f[j])}return h}if(n!=null){m={};m[f]=n}n==null&&at.is(f,"object")&&(m=f);if(m){for(h in this.paper.customAttributes){if(this.paper.customAttributes[aI](h)&&m[aI](h)&&at.is(this.paper.customAttributes[h],"function")){j=this.paper.customAttributes[h].apply(this,[].concat(m[h]));this.attrs[h]=m[h];for(var k in j){j[aI](k)&&(m[k]=j[k])}}}m.text&&this.type=="text"&&(this.node.string=m.text);d(this,m);m.gradient&&({circle:1,ellipse:1}[aI](this.type)||aJ(m.gradient).charAt()!="r")&&bz(this,m.gradient);(!aH[aI](this.type)||this._.rt.deg)&&this.setBox(this.attrs)}return this};a4.toFront=function(){!this.removed&&this.Group.parentNode.appendChild(this.Group);this.paper.top!=this&&i(this,this.paper);return this};a4.toBack=function(){if(this.removed){return this}if(this.Group.parentNode.firstChild!=this.Group){this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild);bL(this,this.paper)}return this};a4.insertAfter=function(f){if(this.removed){return this}f.constructor==bF&&(f=f[f.length-1]);f.Group.nextSibling?f.Group.parentNode.insertBefore(this.Group,f.Group.nextSibling):f.Group.parentNode.appendChild(this.Group);bw(this,f,this.paper);return this};a4.insertBefore=function(f){if(this.removed){return this}f.constructor==bF&&(f=f[0]);f.Group.parentNode.insertBefore(this.Group,f.Group);a3(this,f,this.paper);return this};a4.blur=function(f){var j=this.node.runtimeStyle,h=j.filter;h=h.replace(p,"");if(+f!==0){this.attrs.blur=f;j.filter=h+aT+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+f||1.5)+")";j.margin=at.format("-{0}px 0 0 -{0}px",aZ(+f||1.5))}else{j.filter=h;j.margin=0;delete this.attrs.blur}};l=function(f,n,m,j){var h=L("group"),k=L("oval");h.style.cssText="position:absolute;left:0;top:0;width:"+f.width+"px;height:"+f.height+"px";h.coordsize=a7;h.coordorigin=f.coordorigin;h.appendChild(k);k=new aF(k,h,f);k.type="circle";d(k,{stroke:"#000",fill:"none"});k.attrs.cx=n;k.attrs.cy=m;k.attrs.r=j;k.setBox({x:n-j,y:m-j,width:j*2,height:j*2});f.canvas.appendChild(h);return k};var bT=function(f,m,k,j,h){return h?at.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",f+h,m,k-h*2,h,-h,j-h*2,h*2-k,h*2-j):at.format("M{0},{1}l{2},0,0,{3},{4},0z",f,m,k,j,-k)};bP=function(h,s,o,k,j,n){var f=bT(s,o,k,j,n);h=h.path(f);var m=h.attrs;h.X=m.x=s;h.Y=m.y=o;h.W=m.width=k;h.H=m.height=j;m.r=n;m.path=f;h.type="rect";return h};bA=function(h,o,n,k,j){var m=L("group"),f=L("oval");m.style.cssText="position:absolute;left:0;top:0;width:"+h.width+"px;height:"+h.height+"px";m.coordsize=a7;m.coordorigin=h.coordorigin;m.appendChild(f);f=new aF(f,m,h);f.type="ellipse";d(f,{stroke:"#000"});f.attrs.cx=o;f.attrs.cy=n;f.attrs.rx=k;f.attrs.ry=j;f.setBox({x:o-k,y:n-j,width:k*2,height:j*2});h.canvas.appendChild(m);return f};bc=function(h,s,o,k,j,n){var f=L("group"),m=L("image");f.style.cssText="position:absolute;left:0;top:0;width:"+h.width+"px;height:"+h.height+"px";f.coordsize=a7;f.coordorigin=h.coordorigin;m.src=s;f.appendChild(m);m=new aF(m,f,h);m.type="image";m.attrs.src=s;m.attrs.x=o;m.attrs.y=k;m.attrs.w=j;m.attrs.h=n;m.setBox({x:o,y:k,width:j,height:n});h.canvas.appendChild(f);return m};aK=function(u,s,o,m){var k=L("group"),n=L("shape"),j=n.style,h=L("path"),f=L("textpath");k.style.cssText="position:absolute;left:0;top:0;width:"+u.width+"px;height:"+u.height+"px";k.coordsize=a7;k.coordorigin=u.coordorigin;h.v=at.format("m{0},{1}l{2},{1}",aZ(s*10),aZ(o*10),aZ(s*10)+1);h.textpathok=true;j.width=u.width;j.height=u.height;f.string=aJ(m);f.on=true;n.appendChild(f);n.appendChild(h);k.appendChild(n);j=new aF(f,k,u);j.shape=n;j.textpath=h;j.type="text";j.attrs.text=m;j.attrs.x=s;j.attrs.y=o;j.attrs.w=1;j.attrs.h=1;d(j,{font:ah.font,stroke:"none",fill:"#000"});j.setBox();u.canvas.appendChild(k);return j};ai=function(f,j){var h=this.canvas.style;f==+f&&(f+="px");j==+j&&(j+="px");h.width=f;h.height=j;h.clip="rect(0 "+f+" "+j+" 0)";return this};var L;aC.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!aC.namespaces.rvml&&aC.namespaces.add("rvml","urn:schemas-microsoft-com:vml");L=function(f){return aC.createElement("<rvml:"+f+' class="rvml">')}}catch(bo){L=function(f){return aC.createElement("<"+f+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}bH=function(){var h=ad[aV](0,arguments),s=h.container,o=h.height,k=h.width,j=h.x;h=h.y;if(!s){throw Error("VML container not found.")}var n=new bd,f=n.canvas=aC.createElement("div"),m=f.style;j=j||0;h=h||0;k=k||512;o=o||342;k==+k&&(k+="px");o==+o&&(o+="px");n.width=1000;n.height=1000;n.coordsize=10000+aT+10000;n.coordorigin="0 0";n.span=aC.createElement("span");n.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";f.appendChild(n.span);m.cssText=at.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",k,o);if(s==1){aC.body.appendChild(f);m.left=j+"px";m.top=h+"px";m.position="absolute"}else{s.firstChild?s.insertBefore(f,s.firstChild):s.appendChild(f)}Y.call(n,n,at.fn);return n};a0.clear=function(){this.canvas.innerHTML="";this.span=aC.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};a0.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var f in this){this[f]=aD(f)}return true}}bp=navigator.userAgent.match(/Version\\x2f(.*?)\s/);navigator.vendor=="Apple Computer, Inc."&&(bp&&bp[1]<4||navigator.platform.slice(0,2)=="iP")?a0.safari=function(){var f=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});aw.setTimeout(function(){f.remove()})}:a0.safari=function(){};var be=function(){this.returnValue=false},aL=function(){return this.originalEvent.preventDefault()},aj=function(){this.cancelBubble=true},K=function(){return this.originalEvent.stopPropagation()},bU=function(){if(aC.addEventListener){return function(f,n,m,j){var h=ae&&a5[n]?a5[n]:n,k=function(o){if(ae&&a5[aI](n)){for(var u=0,s=o.targetTouches&&o.targetTouches.length;u<s;u++){if(o.targetTouches[u].target==f){s=o;o=o.targetTouches[u];o.originalEvent=s;o.preventDefault=aL;o.stopPropagation=K;break}}}return m.call(j,o)};f.addEventListener(h,k,false);return function(){f.removeEventListener(h,k,false);return true}}}if(aC.attachEvent){return function(f,m,k,j){var h=function(n){n=n||aw.event;n.preventDefault=n.preventDefault||be;n.stopPropagation=n.stopPropagation||aj;return k.call(j,n)};f.attachEvent("on"+m,h);return function(){f.detachEvent("on"+m,h);return true}}}}(),aO=[],bJ=function(u){for(var s=u.clientX,o=u.clientY,m=aC.documentElement.scrollTop||aC.body.scrollTop,k=aC.documentElement.scrollLeft||aC.body.scrollLeft,n,j=aO.length;j--;){n=aO[j];if(ae){for(var h=u.touches.length,f;h--;){f=u.touches[h];if(f.identifier==n.el._drag.id){s=f.clientX;o=f.clientY;(u.originalEvent?u.originalEvent:u).preventDefault();break}}}else{u.preventDefault()}s+=k;o+=m;n.move&&n.move.call(n.move_scope||n.el,s-n.el._drag.x,o-n.el._drag.y,s,o,u)}},bt=function(f){at.unmousemove(bJ).unmouseup(bt);for(var j=aO.length,h;j--;){h=aO[j];h.el._drag={};h.end&&h.end.call(h.end_scope||h.start_scope||h.move_scope||h.el,f)}aO=[]};for(bp=ao[aB];bp--;){(function(f){at[f]=aF[a8][f]=function(j,h){if(at.is(j,"function")){this.events=this.events||[];this.events.push({name:f,f:j,unbind:bU(this.shape||this.node||aC,f,j,h||this)})}return this};at["un"+f]=aF[a8]["un"+f]=function(k){for(var j=this.events,h=j[aB];h--;){if(j[h].name==f&&j[h].f==k){j[h].unbind();j.splice(h,1);!j.length&&delete this.events;break}}return this}})(ao[bp])}a4.hover=function(f,k,j,h){return this.mouseover(f,j).mouseout(k,h||j)};a4.unhover=function(f,h){return this.unmouseover(f).unmouseout(h)};a4.drag=function(f,n,m,j,h,k){this._drag={};this.mousedown(function(o){(o.originalEvent||o).preventDefault();var u=aC.documentElement.scrollTop||aC.body.scrollTop,s=aC.documentElement.scrollLeft||aC.body.scrollLeft;this._drag.x=o.clientX+s;this._drag.y=o.clientY+u;this._drag.id=o.identifier;n&&n.call(h||j||this,o.clientX+s,o.clientY+u,o);!aO.length&&at.mousemove(bJ).mouseup(bt);aO.push({el:this,move:f,end:m,move_scope:j,start_scope:h,end_scope:k})});return this};a4.undrag=function(f,j,h){for(j=aO.length;j--;){aO[j].el==this&&aO[j].move==f&&aO[j].end==h&&aO.splice(j++,1)}!aO.length&&at.unmousemove(bJ).unmouseup(bt)};a0.circle=function(f,j,h){return l(this,f||0,j||0,h||0)};a0.rect=function(f,m,k,j,h){return bP(this,f||0,m||0,k||0,j||0,h||0)};a0.ellipse=function(f,k,j,h){return bA(this,f||0,k||0,j||0,h||0)};a0.path=function(f){f&&!at.is(f,"string")&&!at.is(f[0],aW)&&(f+="");return af(at.format[aV](at,arguments),this)};a0.image=function(f,m,k,j,h){return bc(this,f||"about:blank",m||0,k||0,j||0,h||0)};a0.text=function(f,j,h){return aK(this,f||0,j||0,aJ(h))};a0.set=function(f){arguments[aB]>1&&(f=Array[a8].splice.call(arguments,0,arguments[aB]));return new bF(f)};a0.setSize=ai;a0.top=a0.bottom=null;a0.raphael=at;a4.resetScale=function(){if(this.removed){return this}this._.sx=1;this._.sy=1;this.attrs.scale="1 1"};a4.scale=function(J,H,G,E){if(this.removed){return this}if(J==null&&H==null){return{x:this._.sx,y:this._.sy,toString:bj}}H=H||J;!+H&&(H=J);var D,F,B=this.attrs;if(J!=0){var A=this.getBBox(),z=A.x+A.width/2,y=A.y+A.height/2;D=ax(J/this._.sx);F=ax(H/this._.sy);G=+G||G==0?G:z;E=+E||E==0?E:y;var x=this._.sx>0,w=this._.sy>0;A=~~(J/ax(J));var v=~~(H/ax(H)),o=D*A,u=F*v,n=this.node.style;z=G+ax(z-G)*o*(z>G==x?1:-1);y=E+ax(y-E)*u*(y>E==w?1:-1);var s=J*A>H*v?F:D;switch(this.type){case"rect":case"image":var k=B.width*D,f=B.height*F;this.attr({height:f,r:B.r*s,width:k,x:z-k/2,y:y-f/2});break;case"circle":case"ellipse":this.attr({rx:B.rx*D,ry:B.ry*F,r:B.r*s,cx:z,cy:y});break;case"text":this.attr({x:z,y:y});break;case"path":s=an(B.path);var C=true;x=x?o:D;w=w?u:F;u=0;for(o=s[aB];u<o;u++){var j=s[u],h=V.call(j[0]);if(!(h=="M"&&C)){C=false;if(h=="A"){j[s[u][aB]-2]*=x;j[s[u][aB]-1]*=w;j[1]*=D;j[2]*=F;j[5]=+(A+v?!!+j[5]:!+j[5])}else{if(h=="H"){h=1;for(var m=j[aB];h<m;h++){j[h]*=x}}else{if(h=="V"){h=1;for(m=j[aB];h<m;h++){j[h]*=w}}else{h=1;for(m=j[aB];h<m;h++){j[h]*=h%2?x:w}}}}}}F=bi(s);D=z-F.x-F.width/2;F=y-F.y-F.height/2;s[0][1]+=D;s[0][2]+=F;this.attr({path:s})}if(this.type in {text:1,image:1}&&(A!=1||v!=1)){if(this.transformations){this.transformations[2]="scale(".concat(A,",",v,")");this.node.setAttribute("transform",this.transformations[au](aT));D=A==-1?-B.x-(k||0):B.x;F=v==-1?-B.y-(f||0):B.y;this.attr({x:D,y:F});B.fx=A-1;B.fy=v-1}else{this.node.filterMatrix=" progid:DXImageTransform.Microsoft"+".Matrix(M11=".concat(A,", M12=0, M21=0, M22=",v,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')");n.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||"")}}else{if(this.transformations){this.transformations[2]="";this.node.setAttribute("transform",this.transformations[au](aT));B.fx=0;B.fy=0}else{this.node.filterMatrix="";n.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||"")}}B.scale=[J,H,G,E][au](aT);this._.sx=J;this._.sy=H}return this};a4.clone=function(){if(this.removed){return null}var f=this.attr();delete f.scale;delete f.translation;return this.paper[this.type]().attr(f)};var aR={},Q=function(A,y,w,s,o,u,m,j,h){var f=0,B=100,z=[A,y,w,s,o,u,m,j].join(),x=aR[z],n,v;!x&&(aR[z]=x={data:[]});x.timer&&clearTimeout(x.timer);x.timer=setTimeout(function(){delete aR[z]},2000);if(h!=null){B=~~Q(A,y,w,s,o,u,m,j)*10}for(var k=0;k<B+1;k++){if(x.data[h]>k){v=x.data[k*B]}else{v=at.findDotsAtSegment(A,y,w,s,o,u,m,j,k/B);x.data[k]=v}k&&(f+=ap(ap(n.x-v.x,2)+ap(n.y-v.y,2),0.5));if(h!=null&&f>=h){return v}n=v}if(h==null){return f}};ao=function(f,h){return function(w,u,s){w=bC(w);for(var v,n,m,k,j="",z={},y=0,x=0,o=w.length;x<o;x++){m=w[x];if(m[0]=="M"){v=+m[1];n=+m[2]}else{k=Q(v,n,m[1],m[2],m[3],m[4],m[5],m[6]);if(y+k>u){if(h&&!z.start){v=Q(v,n,m[1],m[2],m[3],m[4],m[5],m[6],u-y);j+=["C",v.start.x,v.start.y,v.m.x,v.m.y,v.x,v.y];if(s){return j}z.start=j;j=["M",v.x,v.y+"C",v.n.x,v.n.y,v.end.x,v.end.y,m[5],m[6]][au]();y+=k;v=+m[5];n=+m[6];continue}if(!f&&!h){v=Q(v,n,m[1],m[2],m[3],m[4],m[5],m[6],u-y);return{x:v.x,y:v.y,alpha:v.alpha}}}y+=k;v=+m[5];n=+m[6]}j+=m}z.end=j;v=f?y:h?z:at.findDotsAtSegment(v,n,m[1],m[2],m[3],m[4],m[5],m[6],1);v.alpha&&(v={x:v.x,y:v.y,alpha:v.alpha});return v}};var bE=ao(1),bW=ao(),aq=ao(0,1);a4.getTotalLength=function(){if(this.type=="path"){if(this.node.getTotalLength){return this.node.getTotalLength()}return bE(this.attrs.path)}};a4.getPointAtLength=function(f){if(this.type=="path"){return bW(this.attrs.path,f)}};a4.getSubpath=function(f,j){if(this.type=="path"){if(ax(this.getTotalLength()-j)<"1e-6"){return aq(this.attrs.path,f).end}var h=aq(this.attrs.path,j,1);return f?aq(h,f).end:h}};at.easing_formulas={linear:function(f){return f},"<":function(f){return ap(f,3)},">":function(f){return ap(f-1,3)+1},"<>":function(f){f*=2;if(f<1){return ap(f,3)/2}f-=2;return(ap(f,3)+2)/2},backIn:function(f){return f*f*(2.70158*f-1.70158)},backOut:function(f){f-=1;return f*f*(2.70158*f+1.70158)+1},elastic:function(f){if(f==0||f==1){return f}return ap(2,-10*f)*bn.sin((f-0.075)*2*bl/0.3)+1},bounce:function(f){if(f<1/2.75){f*=7.5625*f}else{if(f<2/2.75){f-=1.5/2.75;f=7.5625*f*f+0.75}else{if(f<2.5/2.75){f-=2.25/2.75;f=7.5625*f*f+0.9375}else{f-=2.625/2.75;f=7.5625*f*f+0.984375}}}return f}};var am=[],bm=function(){for(var A=+new Date,y=0;y<am[aB];y++){var w=am[y];if(!(w.stop||w.el.removed)){var s=A-w.start,o=w.ms,u=w.easing,m=w.from,j=w.diff,h=w.to,f=w.t,B=w.el;w={};var z;if(s<o){s=u(s/o);for(var x in m){if(m[aI](x)){switch(bq[x]){case"along":z=s*o*j[x];h.back&&(z=h.len-z);u=bW(h[x],z);B.translate(j.sx-j.x||0,j.sy-j.y||0);j.x=u.x;j.y=u.y;B.translate(u.x-j.sx,u.y-j.sy);h.rot&&B.rotate(j.r+u.alpha,u.x,u.y);break;case aY:z=+m[x]+s*o*j[x];break;case"colour":z="rgb("+[ac(aZ(m[x].r+s*o*j[x].r)),ac(aZ(m[x].g+s*o*j[x].g)),ac(aZ(m[x].b+s*o*j[x].b))][au](",")+")";break;case"path":z=[];u=0;for(var n=m[x][aB];u<n;u++){z[u]=[m[x][u][0]];for(var v=1,k=m[x][u][aB];v<k;v++){z[u][v]=+m[x][u][v]+s*o*j[x][u][v]}z[u]=z[u][au](aT)}z=z[au](aT);break;case"csv":switch(x){case"translation":z=s*o*j[x][0]-f.x;u=s*o*j[x][1]-f.y;f.x+=z;f.y+=u;z=z+aT+u;break;case"rotation":z=+m[x][0]+s*o*j[x][0];m[x][1]&&(z+=","+m[x][1]+","+m[x][2]);break;case"scale":z=[+m[x][0]+s*o*j[x][0],+m[x][1]+s*o*j[x][1],2 in h[x]?h[x][2]:"",3 in h[x]?h[x][3]:""][au](aT);break;case"clip-rect":z=[];for(u=4;u--;){z[u]=+m[x][u]+s*o*j[x][u]}}break;default:n=[].concat(m[x]);z=[];for(u=B.paper.customAttributes[x].length;u--;){z[u]=+n[u]+s*o*j[x][u]}}w[x]=z}}B.attr(w);B._run&&B._run.call(B)}else{if(h.along){u=bW(h.along,h.len*!h.back);B.translate(j.sx-(j.x||0)+u.x-j.sx,j.sy-(j.y||0)+u.y-j.sy);h.rot&&B.rotate(j.r+u.alpha,u.x,u.y)}(f.x||f.y)&&B.translate(-f.x,-f.y);h.scale&&(h.scale+="");B.attr(h);am.splice(y--,1)}}}at.svg&&B&&B.paper&&B.paper.safari();am[aB]&&setTimeout(bm)},bG=function(f,n,m,j,h){var k=m-j;n.timeouts.push(setTimeout(function(){at.is(h,"function")&&h.call(n);n.animate(f,k,f.easing)},j))},ac=function(f){return bh(aE(f,255),0)},ak=function(f,j){if(f==null){return{x:this._.tx,y:this._.ty,toString:bj}}this._.tx+=+f;this._.ty+=+j;switch(this.type){case"circle":case"ellipse":this.attr({cx:+f+this.attrs.cx,cy:+j+this.attrs.cy});break;case"rect":case"image":case"text":this.attr({x:+f+this.attrs.x,y:+j+this.attrs.y});break;case"path":var h=an(this.attrs.path);h[0][1]+=+f;h[0][2]+=+j;this.attr({path:h})}return this};a4.animateWith=function(h,o,n,k,j){for(var m=0,f=am.length;m<f;m++){am[m].el.id==h.id&&(o.start=am[m].start)}return this.animate(o,n,k,j)};a4.animateAlong=aU();a4.animateAlongBack=aU(1);a4.onAnimation=function(f){this._run=f||0;return this};a4.animate=function(D,C,B,z){var y=this;y.timeouts=y.timeouts||[];if(at.is(B,"function")||!B){z=B||null}if(y.removed){z&&z.call(y);return y}var A={},x={},w=false,v={},u;for(u in D){if(D[aI](u)){if(bq[aI](u)||y.paper.customAttributes[aI](u)){w=true;A[u]=y.attr(u);A[u]==null&&(A[u]=ah[u]);x[u]=D[u];switch(bq[u]){case"along":var s=bE(D[u]),o=bW(D[u],s*!!D.back),n=y.getBBox();v[u]=s/C;v.tx=n.x;v.ty=n.y;v.sx=o.x;v.sy=o.y;x.rot=D.rot;x.back=D.back;x.len=s;D.rot&&(v.r=aS(y.rotate())||0);break;case aY:v[u]=(x[u]-A[u])/C;break;case"colour":A[u]=at.getRGB(A[u]);s=at.getRGB(x[u]);v[u]={r:(s.r-A[u].r)/C,g:(s.g-A[u].g)/C,b:(s.b-A[u].b)/C};break;case"path":s=bC(A[u],x[u]);A[u]=s[0];n=s[1];v[u]=[];s=0;for(o=A[u][aB];s<o;s++){v[u][s]=[0];for(var j=1,m=A[u][s][aB];j<m;j++){v[u][s][j]=(n[s][j]-A[u][s][j])/C}}break;case"csv":o=aJ(D[u]).split(bf);n=aJ(A[u]).split(bf);switch(u){case"translation":A[u]=[0,0];v[u]=[o[0]/C,o[1]/C];break;case"rotation":A[u]=n[1]==o[1]&&n[2]==o[2]?n:[0,o[1],o[2]];v[u]=[(o[0]-A[u][0])/C,0,0];break;case"scale":D[u]=o;A[u]=aJ(A[u]).split(bf);v[u]=[(o[0]-A[u][0])/C,(o[1]-A[u][1])/C,0,0];break;case"clip-rect":A[u]=aJ(A[u]).split(bf);v[u]=[];for(s=4;s--;){v[u][s]=(o[s]-A[u][s])/C}}x[u]=o;break;default:o=[].concat(D[u]);n=[].concat(A[u]);v[u]=[];for(s=y.paper.customAttributes[u][aB];s--;){v[u][s]=((o[s]||0)-(n[s]||0))/C}}}}}if(w){u=at.easing_formulas[B];if(!u){if((u=aJ(B).match(bV))&&u[aB]==5){var h=u;u=function(E){return aA(E,+h[1],+h[2],+h[3],+h[4],C)}}else{u=function(E){return E}}}am.push({start:D.start||+new Date,ms:C,easing:u,from:A,diff:v,to:x,el:y,t:{x:0,y:0}});at.is(z,"function")&&(y._ac=setTimeout(function(){z.call(y)},C));am[aB]==1&&setTimeout(bm)}else{B=[];var k,f;for(f in D){if(D[aI](f)&&aN.test(f)){u={value:D[f]};f=="from"&&(f=0);f=="to"&&(f=100);u.key=bg(f,10);B.push(u)}}B.sort(br);B[0].key&&B.unshift({key:0,value:y.attrs});s=0;for(o=B[aB];s<o;s++){bG(B[s].value,y,C/100*B[s].key,C/100*(B[s-1]&&B[s-1].key||0),B[s-1]&&B[s-1].value.callback)}(k=B[B[aB]-1].value.callback)&&y.timeouts.push(setTimeout(function(){k.call(y)},C))}return this};a4.stop=function(){for(var f=0;f<am.length;f++){am[f].el.id==this.id&&am.splice(f--,1)}f=0;for(ii=this.timeouts&&this.timeouts.length;f<ii;f++){clearTimeout(this.timeouts[f])}this.timeouts=[];clearTimeout(this._ac);delete this._ac;return this};a4.translate=function(f,h){return this.attr({translation:f+" "+h})};a4[bD]=function(){return"Rapha\u00ebl\u2019s object"};at.ae=am;var bF=function(f){this.items=[];this[aB]=0;this.type="set";if(f){for(var j=0,h=f[aB];j<h;j++){if(f[j]&&(f[j].constructor==aF||f[j].constructor==bF)){this[this.items[aB]]=this.items[this.items[aB]]=f[j];this[aB]++}}}};bF[a8][bv]=function(){for(var f,k,j=0,h=arguments[aB];j<h;j++){if((f=arguments[j])&&(f.constructor==aF||f.constructor==bF)){k=this.items[aB];this[k]=this.items[k]=f;this[aB]++}}return this};bF[a8].pop=function(){delete this[this[aB]--];return this.items.pop()};for(var g in a4){a4[aI](g)&&(bF[a8][g]=function(f){return function(){for(var j=0,h=this.items[aB];j<h;j++){this.items[j][f][aV](this.items[j],arguments)}return this}}(g))}bF[a8].attr=function(f,k){if(f&&at.is(f,aW)&&at.is(f[0],"object")){for(var j=0,h=f[aB];j<h;j++){this.items[j].attr(f[j])}}else{j=0;for(h=this.items[aB];j<h;j++){this.items[j].attr(f,k)}}return this};bF[a8].animate=function(u,s,o,m){(at.is(o,"function")||!o)&&(m=o||null);var k=this.items[aB],n=k,j,h=this,f;m&&(f=function(){!--k&&m.call(h)});o=at.is(o,"string")?o:f;for(j=this.items[--n].animate(u,s,o,f);n--;){this.items[n]&&!this.items[n].removed&&this.items[n].animateWith(j,u,s,o,f)}return this};bF[a8].insertAfter=function(f){for(var h=this.items[aB];h--;){this.items[h].insertAfter(f)}return this};bF[a8].getBBox=function(){for(var f=[],n=[],m=[],j=[],h=this.items[aB];h--;){var k=this.items[h].getBBox();f[bv](k.x);n[bv](k.y);m[bv](k.x+k.width);j[bv](k.y+k.height)}f=aE[aV](0,f);n=aE[aV](0,n);return{x:f,y:n,width:bh[aV](0,m)-f,height:bh[aV](0,j)-n}};bF[a8].clone=function(f){f=new bF;for(var j=0,h=this.items[aB];j<h;j++){f[bv](this.items[j].clone())}return f};at.registerFont=function(f){if(!f.face){return f}this.fonts=this.fonts||{};var n={w:f.w,face:{},glyphs:{}},m=f.face["font-family"],j;for(j in f.face){f.face[aI](j)&&(n.face[j]=f.face[j])}this.fonts[m]?this.fonts[m][bv](n):this.fonts[m]=[n];if(!f.svg){n.face["units-per-em"]=bg(f.face["units-per-em"],10);for(var h in f.glyphs){if(f.glyphs[aI](h)){m=f.glyphs[h];n.glyphs[h]={w:m.w,k:{},d:m.d&&"M"+m.d.replace(/[mlcxtrv]/g,function(o){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[o]||"M"})+"z"};if(m.k){for(var k in m.k){m[aI](k)&&(n.glyphs[h].k[k]=m.k[k])}}}}}return f};a0.getFont=function(h,o,n,k){k=k||"normal";n=n||"normal";o=+o||{normal:400,bold:700,lighter:300,bolder:800}[o]||400;if(at.fonts){var j=at.fonts[h];if(!j){h=RegExp("(^|\\s)"+h.replace(/[^\w\d\s+!~.:_-]/g,"")+"(\\s|$)","i");for(var m in at.fonts){if(at.fonts[aI](m)){if(h.test(m)){j=at.fonts[m];break}}}}var f;if(j){m=0;for(h=j[aB];m<h;m++){f=j[m];if(f.face["font-weight"]==o&&(f.face["font-style"]==n||!f.face["font-style"])&&f.face["font-stretch"]==k){break}}}return f}};a0.print=function(y,w,u,o,n,s,k){s=s||"middle";k=bh(aE(k||0,1),-1);var j=this.set(),h=aJ(u).split(""),f=0;at.is(o,u)&&(o=this.getFont(o));if(o){u=(n||16)/o.face["units-per-em"];var z=o.face.bbox.split(bf);n=+z[0];s=+z[1]+(s=="baseline"?z[3]-z[1]+ +o.face.descent:(z[3]-z[1])/2);z=0;for(var x=h[aB];z<x;z++){var v=z&&o.glyphs[h[z-1]]||{},m=o.glyphs[h[z]];f+=z?(v.w||o.w)+(v.k&&v.k[h[z]]||0)+o.w*k:0;m&&m.d&&j[bv](this.path(m.d).attr({fill:"#000",stroke:"none",translation:[f,0]}))}j.scale(u,u,n,s).translate(y-n,w-s)}return j};at.format=function(f,j){var h=at.is(j,aW)?[0].concat(j):arguments;f&&at.is(f,"string")&&h[aB]-1&&(f=f.replace(ar,function(m,k){return h[++k]==null?"":h[k]}));return f||""};at.ninja=function(){a9.was?aw.Raphael=a9.is:delete Raphael;return at};at.el=a4;at.st=bF[a8];a9.was?aw.Raphael=at:Raphael=at})();(function(){function r(f){return(f+"").replace(P,"")}function c(k,h,n){for(var f=k.length;f<h;f++){k=n?"0"+k:k+"0"}return k}function j(f){return o.call(f)==="[object Array]"}function B(k,h){if(k.indexOf){return k.indexOf(h)}for(var n=0,f=k.length;n<f;n++){if(k[n]===h){return n}}return -1}function e(k,h,n){var f=h["-"];h=h["+"];var s;switch(n){case"n -":f=" "+f;h=" "+h;case"n-":if(k.substr(k.length-f.length)===f){s=["-",k.substr(0,k.length-f.length)]}else{if(k.substr(k.length-h.length)===h){s=["+",k.substr(0,k.length-h.length)]}}break;case"- n":f+=" ";h+=" ";case"-n":if(k.indexOf(f)===0){s=["-",k.substr(f.length)]}else{if(k.indexOf(h)===0){s=["+",k.substr(h.length)]}}break;case"(n)":if(k.indexOf("(")===0&&k.substr(k.length-1)===")"){s=["-",k.substr(1,k.length-2)]}}return s||["",k]}function D(k,h){if(!h){return 0}for(var s,f=k.getTime(),w=0,n=h.length;w<n;w++){s=h[w].start;if(s===null||f>=s){return w}}return 0}function y(f){return f.split("\u00a0").join(" ").toUpperCase()}function l(k){for(var h=[],n=0,f=k.length;n<f;n++){h[n]=y(k[n])}return h}function p(k,h,n,f){k=k.getFullYear();if(!f&&h.eras){k-=h.eras[n].offset}return k}function q(k,h){for(var s=0,f=false,w=0,n=k.length;w<n;w++){var x=k.charAt(w);switch(x){case"'":if(f){h.push("'")}else{s++}f=false;break;case"\\":f&&h.push("\\");f=!f;break;default:h.push(x);f=false}}return s}function K(k,h){h=h||"F";var n;n=k.patterns;var f=h.length;if(f===1){n=n[h];if(!n){throw"Invalid date format string '"+h+"'."}h=n}else{if(f===2&&h.charAt(0)==="%"){h=h.charAt(1)}}return h}function I(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g}function A(E,O,F){E=r(E);F=F.calendar;a:{var J=F._parseRegExp;if(J){var G=J[O];if(G){O=G;break a}}else{F._parseRegExp=J={}}G=K(F,O).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");for(var T=["^"],M=[],z=0,H=0,s=I(),k;(k=s.exec(G))!==null;){var h=G.slice(z,k.index);z=s.lastIndex;H+=q(h,T);if(H%2){T.push(k[0])}else{h=k[0];var w=h.length;switch(h){case"dddd":case"ddd":case"MMMM":case"MMM":case"gg":case"g":h="(\\D+)";break;case"tt":case"t":h="(\\D*)";break;case"yyyy":case"fff":case"ff":case"f":h="(\\d{"+w+"})";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":h="(\\d\\d?)";break;case"zzz":h="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":h="([+-]?\\d\\d?)";break;case"/":h="(\\"+F["/"]+")";break;default:throw"Invalid date format pattern '"+h+"'."}h&&T.push(h);M.push(k[0])}}q(G.slice(z),T);T.push("$");G={regExp:T.join("").replace(/\s+/g,"\\s+"),groups:M};O=J[O]=G}H=RegExp(O.regExp).exec(E);if(H===null){return null}s=O.groups;var U=E=null,N=null,Q=O=null;M=T=G=J=0;k=null;z=false;h=0;for(w=s.length;h<w;h++){var V=H[h+1];if(V){var S=s[h],n=S.length,f=parseInt(V,10);switch(S){case"dd":case"d":O=f;if(O<1||O>31){return null}break;case"MMM":case"MMMM":N=F;n=n===3;S=N.months;var x=N.monthsGenitive||N.months,C=N._upperMonths;f=N._upperMonthsGen;if(!C){N._upperMonths=C=[l(S.names),l(S.namesAbbr)];N._upperMonthsGen=f=[l(x.names),l(x.namesAbbr)]}V=y(V);N=B(n?C[1]:C[0],V);if(N<0){N=B(n?f[1]:f[0],V)}if(N<0||N>11){return null}break;case"M":case"MM":N=f-1;if(N<0||N>11){return null}break;case"y":case"yy":case"yyyy":if(n<4){U=F;V=f;f=new Date;S=D(f);if(V<100){n=U.twoDigitYearMax;n=typeof n==="string"?(new Date).getFullYear()%100+parseInt(n,10):n;U=p(f,U,S);V+=U-U%100;if(V>n){V-=100}}U=V}else{U=f}if(U<0||U>9999){return null}break;case"h":case"hh":J=f;if(J===12){J=0}if(J<0||J>11){return null}break;case"H":case"HH":J=f;if(J<0||J>23){return null}break;case"m":case"mm":G=f;if(G<0||G>59){return null}break;case"s":case"ss":T=f;if(T<0||T>59){return null}break;case"tt":case"t":z=F.PM&&(V===F.PM[0]||V===F.PM[1]||V===F.PM[2]);if(!z&&(!F.AM||V!==F.AM[0]&&V!==F.AM[1]&&V!==F.AM[2])){return null}break;case"f":case"ff":case"fff":M=f*Math.pow(10,3-n);if(M<0||M>999){return null}break;case"ddd":case"dddd":Q=V;V=n===3;f=void 0;f=F.days;n=F._upperDays;if(!n){F._upperDays=n=[l(f.names),l(f.namesAbbr),l(f.namesShort)]}Q=y(Q);if(V){f=B(n[1],Q);if(f===-1){f=B(n[2],Q)}}else{f=B(n[0],Q)}Q=f;if(Q<0||Q>6){return null}break;case"zzz":n=V.split(/:/);if(n.length!==2){return null}k=parseInt(n[0],10);if(k<-12||k>13){return null}n=parseInt(n[1],10);if(n<0||n>59){return null}k=k*60+(V.indexOf("-")===0?-n:n);break;case"z":case"zz":k=f;if(k<-12||k>13){return null}k*=60;break;case"g":case"gg":if(!V||!F.eras){return null}V=r(V.toLowerCase());n=0;for(f=F.eras.length;n<f;n++){if(V===F.eras[n].name.toLowerCase()){E=n;break}}if(E===null){return null}}}}H=new Date;s=(h=F.convert)?h.fromGregorian(H)[0]:H.getFullYear();if(U===null){U=s}else{if(F.eras){U+=F.eras[E||0].offset}}if(N===null){N=0}if(O===null){O=1}if(h){H=h.toGregorian(U,N,O);if(H===null){return null}}else{H.setFullYear(U,N,O);if(H.getDate()!==O){return null}if(Q!==null&&H.getDay()!==Q){return null}}if(z&&J<12){J+=12}H.setHours(J,G,T,M);if(k!==null){F=H.getMinutes()-(k+H.getTimezoneOffset());H.setHours(H.getHours()+parseInt(F/60,10),F%60)}return H}function u(w,H,x){function E(T,S){var R;R=T+"";if(S>1&&R.length<S){R=f[S-2]+R;return R.substr(R.length-S,S)}return R}function z(){if(n||O){return n}n=G.test(H);O=true;return n}function N(S,R){if(M){return M[R]}switch(R){case 0:return S.getFullYear();case 1:return S.getMonth();case 2:return S.getDate()}}var F=x.calendar,s=F.convert;if(!H||!H.length||H==="i"){if(x&&x.name.length){if(s){x=u(w,F.patterns.F,x)}else{x=new Date(w.getTime());var C=D(w,F.eras);x.setFullYear(p(w,F,C));x=x.toLocaleString()}}else{x=w.toString()}return x}C=F.eras;var k=H==="s";H=K(F,H);x=[];var h,f=["0","00","000"],n,O,G=/([^d]|^)(d|dd)([^d]|$)/g,J=0,Q=I(),M;if(!k&&s){M=s.fromGregorian(w)}for(;;){h=Q.lastIndex;s=Q.exec(H);h=H.slice(h,s?s.index:H.length);J+=q(h,x);if(!s){break}if(J%2){x.push(s[0])}else{h=s[0];s=h.length;switch(h){case"ddd":case"dddd":x.push((s===3?F.days.namesAbbr:F.days.names)[w.getDay()]);break;case"d":case"dd":n=true;x.push(E(N(w,2),s));break;case"MMM":case"MMMM":h=N(w,1);x.push(F.monthsGenitive&&z()?F.monthsGenitive[s===3?"namesAbbr":"names"][h]:F.months[s===3?"namesAbbr":"names"][h]);break;case"M":case"MM":x.push(E(N(w,1)+1,s));break;case"y":case"yy":case"yyyy":h=M?M[0]:p(w,F,D(w,C),k);if(s<4){h%=100}x.push(E(h,s));break;case"h":case"hh":h=w.getHours()%12;if(h===0){h=12}x.push(E(h,s));break;case"H":case"HH":x.push(E(w.getHours(),s));break;case"m":case"mm":x.push(E(w.getMinutes(),s));break;case"s":case"ss":x.push(E(w.getSeconds(),s));break;case"t":case"tt":h=w.getHours()<12?F.AM?F.AM[0]:" ":F.PM?F.PM[0]:" ";x.push(s===1?h.charAt(0):h);break;case"f":case"ff":case"fff":x.push(E(w.getMilliseconds(),3).substr(0,s));break;case"z":case"zz":h=w.getTimezoneOffset()/60;x.push((h<=0?"+":"-")+E(Math.floor(Math.abs(h)),s));break;case"zzz":h=w.getTimezoneOffset()/60;x.push((h<=0?"+":"-")+E(Math.floor(Math.abs(h)),2)+":"+E(Math.abs(w.getTimezoneOffset()%60),2));break;case"g":case"gg":F.eras&&x.push(F.eras[D(w,C)].name);break;case"/":x.push(F["/"]);break;default:throw"Invalid date format pattern '"+h+"'."}}}return x.join("")}var v={},i={en:{}};i["default"]=i.en;v.extend=function(k){for(var h=arguments[1]||{},s=2,f=arguments.length;s<f;s++){var w=arguments[s];if(w){for(var n in w){var x=w[n];if(typeof x!=="undefined"){if(k&&(o.call(x)==="[object Object]"||j(x))){var z=h[n];z=z&&(o.call(z)==="[object Object]"||j(z))?z:j(x)?[]:{};h[n]=this.extend(true,z,x)}else{h[n]=x}}}}}return h};v.findClosestCulture=function(z){var s;if(!z){return this.culture||this.cultures["default"]}if(o.call(z)==="[object String]"){z=z.split(",")}if(j(z)){var C,n=this.cultures,f=z,w,k=f.length,x=[];for(w=0;w<k;w++){z=r(f[w]);z=z.split(";");C=r(z[0]);if(z.length===1){z=1}else{z=r(z[1]);if(z.indexOf("q=")===0){z=z.substr(2);z=parseFloat(z,10);z=isNaN(z)?0:z}else{z=1}}x.push({lang:C,pri:z})}x.sort(function(F,E){return F.pri<E.pri?1:-1});for(w=0;w<k;w++){C=x[w].lang;if(s=n[C]){return s}}for(w=0;w<k;w++){C=x[w].lang;do{f=C.lastIndexOf("-");if(f===-1){break}C=C.substr(0,f);if(s=n[C]){return s}}while(1)}for(w=0;w<k;w++){C=x[w].lang;for(var h in n){f=n[h];if(f.language==C){return f}}}}else{if(typeof z==="object"){return z}}return s||null};v.preferCulture=function(f){this.culture=this.findClosestCulture(f)||this.cultures["default"]};v.localize=function(k,h,n){if(typeof h!=="string"){h=this.culture.name||this.culture||"default"}h=this.cultures[h]||{name:h};var f=i[h.name];if(arguments.length===3){f||(f=i[h.name]={});f[k]=n}else{if(f){n=f[k]}if(typeof n==="undefined"){if(f=i[h.language]){n=f[k]}if(typeof n==="undefined"){n=i["default"][k]}}}return typeof n==="undefined"?null:n};v.format=function(C,s,E){E=this.findClosestCulture(E);if(typeof C==="number"){var n=C;if(!s||s==="i"){C=E.name.length?n.toLocaleString():n.toString()}else{s=s||"D";E=E.numberFormat;C=Math.abs(n);var f=-1;if(s.length>1){f=parseInt(s.slice(1),10)}var w=s.charAt(0).toUpperCase(),k;switch(w){case"D":s="n";if(f!==-1){C=c(""+C,f,true)}if(n<0){C=-C}break;case"N":k=E;case"C":k=k||E.currency;case"P":k=k||E.percent;s=n<0?k.pattern[0]:k.pattern[1]||"n";if(f===-1){f=k.decimals}b:{var z=C*(w==="P"?100:1);w=k;k=w.groupSizes;C=k[0];n=1;var h=Math.pow(10,f),x=Math.round(z*h)/h;isFinite(x)||(x=z);h="";h=(x+"").split(/e/i);x=h.length>1?parseInt(h[1],10):0;z=h[0];h=z.split(".");z=h[0];h=h.length>1?h[1]:"";if(x>0){h=c(h,x,false);z+=h.slice(0,x);h=h.substr(x)}else{if(x<0){x=-x;z=c(z,x+1);h=z.slice(-x,z.length)+h;z=z.slice(0,-x)}}h=f>0?w["."]+(h.length>f?h.slice(0,f):c(h,f)):"";f=z.length-1;w=w[","];for(x="";f>=0;){if(C===0||C>f){C=z.slice(0,f+1)+(x.length?w+x+h:h);break b}x=z.slice(f-C+1,f+1)+(x.length?w+x:"");f-=C;if(n<k.length){C=k[n];n++}}C=z.slice(0,f+1)+w+x+h}break;default:throw"Bad number format specifier: "+w}k=/n|\$|-|%/g;for(n="";;){f=k.lastIndex;w=k.exec(s);n+=s.slice(f,w?w.index:s.length);if(!w){break}switch(w[0]){case"n":n+=C;break;case"$":n+=E.currency.symbol;break;case"-":if(/[1-9]/.test(C)){n+=E["-"]}break;case"%":n+=E.percent.symbol}}C=n}}else{if(C instanceof Date){C=u(C,s,E)}}return C};v.parseInt=function(h,f,k){return Math.floor(this.parseFloat(h,f,k))};v.parseFloat=function(k,h,s){if(typeof h==="string"){s=h;h=10}s=this.findClosestCulture(s);var f=NaN,w=s.numberFormat;if(k.indexOf(s.numberFormat.currency.symbol)>-1){k=k.replace(s.numberFormat.currency.symbol,"");k=k.replace(s.numberFormat.currency["."],s.numberFormat["."])}k=r(k);if(d.test(k)){f=parseFloat(k,h)}else{if(!h&&L.test(k)){f=parseInt(k,16)}else{s=e(k,w,w.pattern[0]);h=s[0];s=s[1];if(h===""&&w.pattern[0]!=="-n"){s=e(k,w,"-n");h=s[0];s=s[1]}h=h||"+";var n;k=s.indexOf("e");if(k<0){k=s.indexOf("E")}if(k<0){n=s;k=null}else{n=s.substr(0,k);k=s.substr(k+1)}var x=w["."],z=n.indexOf(x);if(z<0){s=n;n=null}else{s=n.substr(0,z);n=n.substr(z+x.length)}x=w[","];s=s.split(x).join("");z=x.replace(/\u00A0/g," ");if(x!==z){s=s.split(z).join("")}h+=s;if(n!==null){h+="."+n}if(k!==null){w=e(k,w,"-n");h+="e"+(w[0]||"+")+w[1]}if(m.test(h)){f=parseFloat(h)}}}return f};v.parseDate=function(k,h,s){s=this.findClosestCulture(s);var f,w;if(h){if(typeof h==="string"){h=[h]}if(h.length){w=0;for(var n=h.length;w<n;w++){var x=h[w];if(x){if(f=A(k,x,s)){break}}}}}else{h=s.calendar.patterns;for(w in h){if(f=A(k,h[w],s)){break}}}return f||null};var g=v.cultures=v.cultures||{};g=g["default"]=g.en=v.extend(true,{name:"en",englishName:"English",nativeName:"English",isRTL:false,language:"en",numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSizes:[3],"+":"+","-":"-",percent:{pattern:["-n %","n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)","$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish","/":"/",":":":",firstDay:0,days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss"}}}},g.en);g.calendar=g.calendar||g.calendars.standard;var P=/^\s+|\s+$/g,d=/^[+-]?infinity$/i,L=/^0x[a-f0-9]+$/i,m=/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/,o=Object.prototype.toString;jQuery.global=v})();(function(c){var d=c({});c.subscribe=function(){d.bind.apply(d,arguments)};c.unsubscribe=function(){d.unbind.apply(d,arguments)};c.publish=function(){d.trigger.apply(d,arguments)}})(jQuery);var timeglider=window.timeglider={version:"0.1.0"};(function(c){c=timeglider;var f=jQuery,h={},g={},d={},j={},e={};c.TG_Date=function(l,n){function q(u){var v=Math.abs(u.rd)*86400,s=u.ho*3600,r=(u.mi-1)*60,k=1;if(u.rd<0){k=-1}return k*(v+s+r)}var m,p,o;if(typeof l=="number"){m=p=i.getDateFromSec(l);o=l}else{if(l=="today"){l=i.getToday()}m=p=l}if(function(k){k=jQuery.trim(k);reg=RegExp(/[T0-9-: ]/);return reg.test(k)?k:false}(m)===false){return{error:"Invalid date"}}else{m=m.replace(",","");if(m.substr(0,1)=="-"){this.bce=1;m=m.substr(1)}else{this.bce=0}m=m.replace(/[^0-9]/g,"-");m=m.split("-");this.ye=this.bce===0?parseInt(m[0],10):-1*parseInt(m[0],10);this.mo=parseInt(m[1],10);this.mo_num=this.ye>0?(this.ye-1)*12+this.mo:-1*((Math.abs(this.ye)-1)*12+(12-(this.mo-1)));this.da=parseInt(m[2],10);this.ho=parseInt(m[3],10)||0;this.mi=parseInt(m[4],10)||0;this.se=parseInt(m[5],10)||0;this.rd=i.getRataDie(this);this.sec=o||q(this);this.date_display=n?n.toLowerCase().substr(0,2):"";this.jsDate=new Date(this.ye,this.mo-1,this.da,this.ho,this.mi,this.se,0);this.dateStr=p}};var i=c.TG_Date;i.getTimeUnitSerial=function(k,l){var m=0;switch(l){case"ye":m=k.ye;break;case"mo":m=k.mo_num;break;case"da":m=k.rd;break;case"de":m=Math.floor(k.ye/10);break;case"ce":m=Math.floor(k.ye/100);break;case"thou":m=Math.floor(k.ye/1000);break;case"tenthou":m=Math.floor(k.ye/10000);break;case"hundredthou":m=Math.floor(k.ye/100000);break;case"mill":m=Math.floor(k.ye/1000000);break;case"tenmill":m=Math.floor(k.ye/10000000);break;case"hundredmill":m=Math.floor(k.ye/100000000);break;case"bill":m=Math.floor(k.ye/1000000000)}return m};i.getMonthDays=function(k,l){return i.isLeapYear(l)==true&&k==2?29:i.monthsDayNums[k]};i.twentyFourToTwelve=function(k){var l={};l.ye=k.ye;l.mo=k.mo;l.da=k.da;l.ho=k.ho;l.mi=k.mi;l.ampm="am";if(k.ho){if(k.ho>=12){l.ampm="pm";l.ho=k.ho>12?k.ho-12:12}else{if(k.ho==0){l.ho=12;l.ampm="am"}else{l.ho=k.ho}}}else{l.ho=12;l.mi=0;l.ampm="am"}return l};i.getMonthAdj=function(k,l){var m=i.getDateFromMonthNum(k);switch(m.mo){case 1:case 3:case 5:case 7:case 8:case 10:case 12:m=Math.floor(l+l/28*3);return{width:m,days:31};case 2:if(i.isLeapYear(m.ye)==true){m=Math.floor(l+l/28);return{width:m,days:29}}else{return{width:l,days:28}}default:m=Math.floor(l+l/28*2);return{width:m,days:30}}};i.getDateFromMonthNum=function(k){var l=0;if(k>0){l=k%12;if(l==0){l=12}k=Math.ceil(k/12)}else{l=Math.abs(k)%12;l=12-l+1;if(l==13){l=1}k=-1*Math.ceil(Math.abs(k)/12)}return{ye:k,mo:l}};i.getMonthWidth=function(l,n,o){n=t/28;var m;switch(l){case 1:case 3:case 5:case 7:case 8:case 10:case 12:m=3;break;case 4:case 6:case 9:case 11:m=2;break;case 2:m=i.isLeapYear(yr)==true?1:0}return{width:Math.floor(o+n*m),numDays:28+m}};i.getToday=function(){var k=new Date;return k.getFullYear()+"-"+(k.getMonth()+1)+"-"+k.getDate()+" "+k.getHours()+":"+k.getMinutes()+":00"};i.getMonthFromRemDays=function(l,n){var o=0;var m=o=0;o=i.isLeapYear(n)?1:0;if(l<=31){m=1;o=l}else{if(l>31&&l<=59+o){m=2;o=l-(31+o)}else{if(l>59+o&&l<=90+o){m=3;o=l-(59+o)}else{if(l>90+o&&l<=120+o){m=4;o=l-(90+o)}else{if(l>120+o&&l<=151+o){m=5;o=l-(120+o)}else{if(l>151+o&&l<=181+o){m=6;o=l-(151+o)}else{if(l>181+o&&l<=212+o){m=7;o=l-(181+o)}else{if(l>212+o&&l<=243+o){m=8;o=l-(212+o)}else{if(l>243+o&&l<=273+o){m=9;o=l-(243+o)}else{if(l>273+o&&l<=304+o){m=10;o=l-(273+o)}else{if(l>304+o&&l<=334+o){m=11;o=l-(304+o)}else{m=12;o=l-(334+o)}}}}}}}}}}}return{mo:m,da:o}};i.getDateFromRD=function(l){if(j[l]){return j[l]}for(var n=Math.floor(l),q=Math.floor(n/146097)*400,m=n-Math.floor(n/146097)*146097,p=1,o=q+1,r=o+400;o<=r;o++){if(m>365){m-=365;if(i.isLeapYear(o)){m-=1}p++}else{o=r}}q+=p;if(m==0){m=1}m=i.getMonthFromRemDays(m,q);p=(l-n)*1440;n=Math.floor(p%60);p=Math.floor(p/60);if(i.isLeapYear(q)&&m.mo==2){m.da+=1}n=q+"-"+m.mo+"-"+m.da+" "+p+":"+n+":00";return j[l]=n};i.getDateFromSec=function(k){if(e[k]){return e[k]}var l=i.getDateFromRD(k/86400);return e[k]=l};i.isLeapYear=function(k){return k%400==0?true:k%100==0?false:k%4==0?true:false};i.getRataDie=function(l){function n(v,s){if(g[v+"-"+s]){return g[v+"-"+s]}for(var k=0,w=v;w<s;w++){k+=i.isLeapYear(w)?366:365}return g[v+"-"+s]=k}function q(v,s){var k;switch(v){case 1:k=0;break;case 2:k=31;break;case 3:k=59;break;case 4:k=90;break;case 5:k=120;break;case 6:k=151;break;case 7:k=181;break;case 8:k=212;break;case 9:k=243;break;case 10:k=273;break;case 11:k=304;break;case 12:k=334}if(v>2){if(i.isLeapYear(s)){k+=1}}return k}var m=l.ye,p=l.mo;l=l.da;var o=0;if(h[m+"-"+p+"-"+l]){return h[m+"-"+p+"-"+l]}if(m>=0){if(m==0){m=1}o=Math.floor(m/400)*146097;var r=parseInt(n(m-m%400,m)),u=parseInt(q(p,m));o=o+r+u+l-366}else{if(m<0){o=i.getBCRataDie({ye:m,mo:p,da:l})}}return h[m+"-"+p+"-"+l]=o};i.getBCRataDie=function(l){var n=l.ye,o=l.mo;l=l.da;if(d[n+"-"+o+"-"+l]){return d[n+"-"+o+"-"+l]}if(o==0){o=1}if(l==0){l=1}var m=-1*((Math.abs(n)-1)*366+[0,335,306,275,245,214,184,153,122,92,61,31,0][o]+(i.monthsDayNums[o]-l+1));return d[n+"-"+o+"-"+l]=m};i.setCulture=function(k){jQuery.global.culture=jQuery.global.cultures[k];i.monthNames=f.merge([""],jQuery.global.culture.calendar.months.names);i.monthNamesAbbr=f.merge([""],jQuery.global.culture.calendar.months.namesAbbr);i.monthNamesLet=["","J","F","M","A","M","J","J","A","S","O","N","D"];i.monthsDayNums=[0,31,28,31,30,31,30,31,31,30,31,30,31,29];i.dayNames=jQuery.global.culture.calendar.days.names;i.dayNamesAbbr=jQuery.global.culture.calendar.days.namesAbbr;i.dayNamesShort=jQuery.global.culture.calendar.days.namesShort;i.units=["da","mo","ye","de","ce","thou","tenthou","hundredthou","mill","tenmill","hundredmill","bill"];i.patterns=jQuery.global.culture.calendar.patterns};i.prototype={format:function(k,l){if(l==true){switch(this.date_display.substr(0,2)){case"no":return"";case"ye":k="yyyy";break;case"mo":k="Y";break;case"da":k="D";break;case"ho":k="f";break;default:k="f"}}return f.global.format(this.jsDate,k)}}})(timeglider);(function(c){var d=c.levelHeight=10,e=jQuery;c.TG_Org=function(){this.blocks=[];this.ids=[];this.vis=[];this.tree=[];var g=this;this.addBlock=function(i,j){i.right=i.left+i.width;i.bottom=i.top+i.height;i.tickScope=j;g.blocks.push(i)};this.getBorg=function(){return this};this.getBlocks=function(){return this.blocks};this.getHTML=function(o,p){if(o=="sweep"){g.tree=[];for(var i=0;i<300;i++){g.tree[i]=[]}this.vis=[]}this.blocks.sort(f);var l,n="",j="";b_htm=html="";b={};blength=this.blocks.length;for(var m=title_adj=0;m<blength;m++){b=this.blocks[m];if(b.tickScope==o){if(e.inArray(b.id,this.vis)==-1){this.vis.push(b.id);title_adj=0;if(b.html&&b.html.substr(0,4)=="<div"){b_htm="<div style='left:"+b.left+"px' id='ev_"+b.id+"'"+b.html.substr(4);html+=b_htm}else{if(b.image){if(b.image.display_class=="layout"){title_adj=b.image.height+4}n="<div class='timeglider-event-image-"+b.image.display_class+"'><img src='"+b.image.src+"'></div>"}else{n=""}h(b,0);if(b.y_position>0){b.top=-1*b.y_position}b.fontsize<10?b.opacity=b.fontsize/10:b.opacity=1;if(b.span==true){i="timeglider-event-spanning";l="<div class='timeglider-event-spanner' style='top:"+title_adj+"px;height:"+b.fontsize+"px;width:"+b.spanwidth+"px'></div>"}else{l=i=""}j=b.icon?"<img class='timeglider-event-icon' src='"+b.icon+"' style='height:"+b.fontsize+"px;left:-"+(b.fontsize+2)+"px; top:"+title_adj+"px'>":"";html+=Math.abs(b.top)>p-16?"<div class='timeglider-more-plus' style='left:"+b.left+"px; top:-"+(p-Math.floor(16/3))+"px'>+</div>":"<div class='timeglider-timeline-event "+i+"' id='ev_"+b.id+"' style='width:"+b.width+"px;height:"+b.height+"px;left:"+b.left+"px;opacity:"+b.opacity+";top:"+b.top+"px;font-size:"+b.fontsize+"px;'>"+j+n+l+"<div class='timeglider-event-title' style='top:"+title_adj+"px'>"+b.title+"</div></div>"}}}}return html};var f=function(k,l){var i=l.importance,j=k.importance;return i<j?-1:i>j?1:0},h=function(p,q){var i=false,l=g.tree,o=l[q],j=q+1,n=false,m=2;bump_ht=d;if(o!=undefined){for(m=0;m<o.length;m++){a:{i=o[m];if(!(p.left>i.right||p.right<i.left)){if(p.left>=i.left&&p.left<=i.right||p.right>=i.left&&p.right<=i.right||p.right>=i.right&&p.left<=i.left||p.right<=i.right&&p.left>=i.left){if(p.bottom<=i.bottom&&p.bottom>=i.top||p.top<=i.bottom&&p.top>=i.top||p.top==i.bottom&&p.top==i.top){i=true;break a}}}i=false}if(i==true){p.top-=bump_ht;p.bottom-=bump_ht;h(p,j);n=true;break}}if(n==false){p.top-=p.fontsize;o.push(p);m=Math.ceil(p.height/d);o=0;for(o=1;o<=m;o++){j=q+o;l[j].push(p)}}}}}})(timeglider);(function(c){function e(l){function m(n,o){return function(){return o.apply(n,arguments)}}var i=new Image,j=l.id,k=i.src=l.src;i.onerror=m(i,function(){h.reportImageSize({id:l.id,src:k,error:true})});i.onload=m(i,function(){h.reportImageSize({id:j,src:k,width:this.width,height:this.height})})}var g=c.TG_Date,f=jQuery,d={},h;c.TG_Timeline=Backbone.Model.extend({defaults:{title:"Untitled",events:[],legend:[]},_chewTimeline:function(u){h=u.mediator;d=h.options;var n={da:[],mo:[],ye:[],de:[],ce:[],thou:[],tenthou:[],hundredthou:[],mill:[],tenmill:[],hundredmill:[],bill:[]},o=g.units;u.startSeconds=[];u.endSeconds=[];u.spans=[];u.hasImagesAbove=false;if(!u.color){u.color="#333333"}if(u.events){for(var p,l,i,v,q=u.events.length,r=0;r<q;r++){l=u.events[r];if(l.id){i=l.id}else{l.id=i="anon"+this.anonEventId++}p=l.date_display||l.date_limit||"da";l.date_display=p.toLowerCase().substr(0,2);l.startdateObj=new g(l.startdate,l.date_display);l.enddateObj=new g(l.enddate,l.date_display);l.icon=!l.icon||l.icon==="none"?"":d.icon_folder+l.icon;l.titleWidth=c.getStringWidth(l.title);if(l.image){p=l.image_class||"layout";if(l.image_class=="above"){u.hasImagesAbove=true}l.image={id:l.id,src:l.image,display_class:p};e(l.image);h.imagesToSize++}u.startSeconds.push(l.startdateObj.sec);u.endSeconds.push(l.enddateObj.sec);if(l.enddateObj.sec>l.startdateObj.sec){l.span=true;u.spans.push({id:l.id,start:l.startdateObj.sec,end:l.enddateObj.sec})}else{l.span=false}for(var m=o.length,j=0;j<m;j++){p=o[j];v=g.getTimeUnitSerial(l.startdateObj,p);if(n[p][v]!==undefined){n[p][v].push(i)}else{n[p][v]=[i]}}h.eventPool["ev_"+i]=l}o=f.merge(u.startSeconds,u.endSeconds);o=timeglider.getLowHigh(o);u.bounds={first:o.low,last:o.high}}if(u.legend.length>0){o=u.legend;for(l=0;l<o.length;l++){}}u.display="expanded";u.dateHash=n;delete u.events;return u},initialize:function(i){this.set(this._chewTimeline(i))},validate:function(){}})})(timeglider);(function(j){var d=j.TG_Date,g="",c="",f={},e=jQuery,l={},h="",i,k;debug.trace=function(n,m){e("#"+m).text(n)};j.TG_TimelineView=function(p,m){var o=this;c=m;f=c.options;g="#"+p._id;h=p._id;this._views={PLACE:g,CONTAINER:g+" .timeglider-container",TIMELINE_MENU:g+" .timeglider-timeline-menu",TIMELINE_MENU_UL:g+" .timeglider-timeline-menu ul",TIMELINE_LIST_BT:g+" .timeglider-list-bt",SLIDER_CONTAINER:g+" .timeglider-slider-container",SLIDER:g+" .timeglider-slider",ZOOM_DISPLAY:g+" .timeglider-zoomlevel-display",TRUCK:g+" .timeglider-truck",CENTERLINE:g+" .timeglider-centerline",TICKS:g+" .timeglider-ticks",HANDLE:g+" .timeglider-handle",FOOTER:g+" .timeglider-footer",FILTER_BT:g+" .timeglider-filter-bt",FILTER_BOX:g+" .timeglider-filter-box",TOOLS_BT:g+" .timeglider-tools-bt"};i=this._views.CONTAINER;k=this._views.TICKS;this._templates={};this._templates={test:"testola",event_modal:this.getEventModalTemplate(),event_modal_video:e.template(null,"<div class='tg-modal timeglider-ev-video-modal ui-widget-content' id='${id}_modal'><div class='close-button-remove'></div><iframe width = '100%' height='300' src='${video}'></iframe></div>"),timeline_modal:e.template(null,"<div class='tg-modal timeglider-timeline-modal ui-widget-content' id='tl_${id}_modal'><div class='close-button-remove'></div><h4 id='title'>${title}</h4><p>{{html description}}</p></div>"),filter_modal:e.template(null,"<div class='tg-modal timeglider-menu-modal timeglider-filter-box timeglider-menu-hidden'><div class='close-button'></div><h3>filter</h3><div class='timeglider-menu-modal-content'><div class='timeglider-formline'>show: <input type='text' class='timeglider-filter-include'></div><div class='timeglider-formline'>hide: <input type='text' class='timeglider-filter-exclude'></div><ul><li class='timeglider-filter-clear'>clear</li><li class='timeglider-filter-apply'>apply</li></ul></div><div class='timeglider-menu-modal-point-right'></div>"),timeline_list_modal:e.template(null,"<div class='timeglider-menu-modal timeglider-timeline-menu timeglider-menu-hidden'><div class='close-button'></div><h3>timelines</h3><div class='timeglider-menu-modal-content'><ul></ul></div><div class='timeglider-menu-modal-point-right'></div>"),legend_modal:e.template(null,"<div class='timeglider-menu-modal timeglider-legend timeglider-menu-hidden'  id='${id}_legend'><div class='timeglider-menu-modal-content'><ul id='${id}'>{{html legend_list}}</ul><div class='timeglider-close-button-small timeglider-legend-close'></div><div class='timeglider-legend-all'>all</div></div></div>")};e(i).css("height",e(g).height());this.basicFontSize=f.basic_fontsize;f.show_footer==false&&e(this._views.FOOTER).css("display","none");this.dragSpeed=0;this.dimensions=this.getWidgetDimensions();this.ticksHandleOffset=this.rightside=this.leftside=this.tickNum=0;this.timeoout_id=1;this.sliderActive=false;this.ztop=1000;this.filterBoxActivated=false;this.buildSlider();this.setupFilter();e.subscribe("mediator.timelineDataLoaded",function(){e(".timeglider-loading").fadeOut(500)});e.subscribe("mediator.ticksOffsetChange",function(){o.tickHangies();o.registerTitles();o.registerDragging()});e.subscribe("mediator.zoomLevelChange",function(){o.tickNum=0;o.leftside=0;var q=c.getZoomLevel();e(o._views.SLIDER).slider("value",o.invSliderVal(q));o.displayZoomLevel(q);o.castTicks("zoomLevelChange")});e.subscribe("mediator.ticksReadySignal",function(){c.ticksReady===true&&o.freshTimelines()});e.subscribe("mediator.refreshSignal",function(){o.tickNum=0;o.leftside=0;o.castTicks("refreshSignal")});e.subscribe("mediator.ticksArrayChange",function(){});e.subscribe("mediator.focusDateChange",function(){});e.subscribe("mediator.timelineListChangeSignal",function(){o.buildTimelineMenu()});e.subscribe("mediator.activeTimelinesChange",function(){e(o._views.TIMELINE_MENU_UL+" li").each(function(){var q=e(this).attr("id");e.inArray(q,c.activeTimelines)!=-1?e(this).addClass("activeTimeline"):e(this).removeClass("activeTimeline")})});e.subscribe("mediator.filterChange",function(){});this.setPanButton(e(".timeglider-pan-right"),-30);this.setPanButton(e(".timeglider-pan-left"),30);e(this._views.TRUCK).dblclick(function(r){var s=r.pageX-o.dimensions.container.offset.left-o.dimensions.container.width/2,q=c.getZoomInfo().spp;r=c.getFocusDate().sec;s=new d(Math.floor(r+s*q));r=new d(r);debug.trace("DBLCLICK:"+r.mo+"-"+r.ye+" DBLCLICK:"+s.mo+"-"+s.ye,"note")}).bind("mousewheel",function(s,u){var r=Math.ceil(-1*u*3),q=c.getZoomLevel();c.setZoomLevel(q+r);return false});e(k).draggable({axis:"x",drag:function(){c.setTicksOffset(e(this).position().left)},stop:function(){o.resetTicksHandle();o.registerDragging()}}).delegate(i+" .timeglider-timeline-event","click",function(){var r=e(this).attr("id"),s=c.eventPool[r];if(s.click_callback){r=s.click_callback.split(".");var q=r[0];if(r.length==2){window[q][r[1]](s)}else{window[q](s)}}else{o.eventModal(r)}}).delegate(".timeglider-timeline-event","mouseover",function(){var q=e(this).attr("id");q=c.eventPool[q];debug.trace("hover, title:"+q.title,"note");o.eventHover(e(this),q)}).delegate(".timeglider-timeline-event","mouseout",function(){var q=e(this).attr("id");q=c.eventPool[q];debug.trace("hover, title:"+q.title,"note");o.eventUnHover(e(this),q)}).delegate(".timeglider-event-collapsed","hover",function(){var q=e(this).attr("id");debug.trace("collapsed, title:"+c.eventPool[q].title,"note")});e(i).delegate(".close-button-remove","click",function(){var q=e(this).parent().attr("id");e("#"+q).remove()});e(i).delegate(".full_modal_close","click",function(){e(".full_modal").remove()});e(i).delegate(".full_modal_scrim","click",function(){e(".full_modal").remove()});e(i).delegate(".timeglider-more-plus","click",function(){c.zoom(-1)});e(i+" .timeglider-legend-close").live("click",function(){var q=e(i+" .timeglider-legend");q.fadeOut(300,function(){q.remove()})});e(i+" .timeglider-legend-all").live("click",function(){e(i+" .timeglider-legend li").each(function(){e(this).removeClass("tg-legend-icon-selected")});c.setFilters({origin:"legend",icon:"all"})});e.tmpl(o._templates.timeline_list_modal,{}).appendTo(i);e(o._views.TIMELINE_LIST_BT).click(function(){e(o._views.TIMELINE_MENU).toggleClass("timeglider-menu-hidden").position({my:"right bottom",at:"right top",of:e(o._views.TIMELINE_LIST_BT),offset:"-8, -12"})});e(this._views.TIMELINE_MENU+" .close-button").live("click",function(){e(o._views.TIMELINE_MENU).toggleClass("timeglider-menu-hidden")});e(this._views.TOOLS_BT).click(function(){alert("I'm just a stand-in for the tools... ")});c.options.show_centerline===true?e(this._views.CENTERLINE).css({height:o.dimensions.container.height,left:o.dimensions.container.centerx}):e(this._views.CENTERLINE).css({display:"none"});if(e.support.touch){e("#"+h).addTouch();var n=document.getElementById(h);n.addEventListener("gesturestart",function(q){q.preventDefault();e("#output").append("<br>gesture zoom:"+c.getZoomLevel())},false);n.addEventListener("gestureend",function(q){q.preventDefault();e("#output").append("<br>gesture end:"+c.getZoomLevel())},false);n.addEventListener("gesturechange",function(q){q.preventDefault();e("#output").append("[l:r]")},false)}};j.TG_TimelineView.prototype={getWidgetDimensions:function(){var q=e(i),m=q.width(),p=Math.floor(m/2)+1,o=q.height(),r=Math.floor(o/2),u=q.position().left;q=q.offset();var n=f.show_footer==true?e(this._views.FOOTER).height():0;return{container:{width:m,height:o,centerx:p,centery:r,left:u,offset:q},tick:{top:o-n-30},footer:{height:n}}},getEventModalTemplate:function(){var p=this,m=false,o="",n=e.template(null,"<div class='tg-modal timeglider-ev-modal ui-widget-content' id='ev_${id}_modal'><div class='close-button-remove'></div><div class='startdate'>${startdate}</div><h4 id='title'>${title}</h4><p>{{html description}}</p><ul class='timeglider-ev-modal-links'>{{html links}}</ul></div>");if(f.event_modal.href){e.ajax({url:f.event_modal.href,success:function(q){o=q.removeWhitespace();debug.log("stripped:"+o);p._templates.event_modal=m=e.template(null,o)},error:function(){p._templates.event_modal=m=n;debug.log("Custom event modal HTML file could not be found/loaded! Reverting to default.")}})}else{m=n}return m},scaleToImportance:function(n,m){return n/m},displayZoomLevel:function(m){m>0&&f.display_zoom_level==true&&e(this._views.ZOOM_DISPLAY).text(m)},doSomething:function(){alert("FOO DO, viewer")},setPanButton:function(o,m){var n=this;e(o).live("mousedown",function(){n.intervalMachine("pan",{type:"set",fn:n.pan,args:[m],intvl:33})}).live("mouseup",function(){n.intervalMachine("pan",{type:"clear",fn:n.pan,callback:"resetTicksHandle"})}).live("mouseout",function(){n.intervalMachine("pan",{type:"clear",fn:n.pan,callback:"resetTicksHandle"})})},intervalMachine:function(o,m){var n=this;if(m.type==="clear"){clearInterval(l[o]);if(m.callback){n[m.callback]()}}else{l[o]=setInterval(function(){m.fn.apply(n,m.args)},m.intvl)}},invSliderVal:function(m){return Math.abs(m-101)},pan:function(m){m=m||20;$t=e(k);newPos=$t.position().left+m;$t.css({left:newPos});c.setTicksOffset(newPos)},registerTitles:function(){var p,n,y,w,x,r,o,A,m,q,u,v=e(i).offset().left;e(".timeglider-event-spanning").each(function(){p=e(this).offset().left-v;n=e(this).outerWidth();o=e(".timeglider-event-title",this);y=o.outerWidth()+5;w=o.siblings(".timeglider-event-spanner").outerWidth();w>y&&p<0&&Math.abs(p)<n-y&&o.css({marginLeft:-1*p+5})});e(".tg-timeline-envelope").each(function(){A=e(this).offset().left-v;m=e(".titleBar",this);q=e(".titleBar .timeline-title",this);x=m.position().left;u=x+A;m.outerWidth();y=m.outerWidth();r=-1*u;u<0&&q.css({marginLeft:r+5})})},registerDragging:function(){var o=c.startSec,m=e(k).position().left,n=c.getZoomInfo().spp;o=new d(o-m*n);c.setFocusDate(o)},buildTimelineMenu:function(){var p,m=c.timelinePool,o=0;e(this._views.TIMELINE_MENU_UL+" li").remove();for(p in m){if(m.hasOwnProperty(p)){var n=m[p];e(this._views.TIMELINE_MENU_UL).append("<li class = 'timelineList' id='"+p+"'>"+n.title+"</li>");e("li#"+p).click(function(){c.toggleTimeline(e(this).attr("id"))})}o++}},buildSlider:function(){var p=c.getZoomLevel();if(f.min_zoom==f.max_zoom){e(this._views.SLIDER_CONTAINER).css("display","none")}else{f.display_zoom_level==true&&e("<div>").appendTo(this._views.SLIDER_CONTAINER).addClass("timeglider-zoomlevel-display").html("&nbsp;");var m=this;p=m.invSliderVal(p);var o=c.max_zoom,n=c.min_zoom;e(this._views.SLIDER).css("height",(1+o-n)*3).slider({steps:100,handle:e(".knob"),animate:300,orientation:"vertical",min:m.invSliderVal(o),max:m.invSliderVal(n),value:p,start:function(){m.sliderActive=true},stop:function(){m.sliderActive=false},change:function(){},slide:function(q,r){c.setZoomLevel(m.invSliderVal(r.value))}})}},eventHover:function(o,m){var n=e(".timeglider-event-hover-info");m.date_display!="no"&&n.position({my:"left bottom",at:"left top",of:o,offset:"1, -10",collision:"flip flip"}).text(m.startdateObj.format("D",true));o.addClass("tg-event-hovered")},eventUnHover:function(m){e(".timeglider-event-hover-info").css("left","-1000px");m.removeClass("tg-event-hovered")},setupFilter:function(){var m=this;e.tmpl(m._templates.filter_modal,{}).appendTo(m._views.CONTAINER);e(m._views.FILTER_BT).click(function(){var n=e(this),r=m._views.FILTER_BOX;if(m.filterBoxActivated==false){m.filterBoxActivated=true;var q=e(r+" .timeglider-filter-apply"),u=e(".timeglider-filter-box .close-button"),v=e(r+" .timeglider-filter-clear"),p="",o="";q.click(function(){p=e(r+" .timeglider-filter-include").val();o=e(r+" .timeglider-filter-exclude").val();c.setFilters({origin:"clude",include:p,exclude:o});e(r).toggleClass("timeglider-menu-shown")});u.click(function(){e(r).toggleClass("timeglider-menu-hidden")});v.click(function(){c.setFilters({origin:"clude",include:"",exclude:""});e(r+" .timeglider-filter-include").val("");e(r+" .timeglider-filter-exclude").val("");e(r).toggleClass("timeglider-menu-shown")})}e(r).toggleClass("timeglider-menu-hidden").css("z-index",m.ztop++).position({my:"right bottom",at:"right top",of:n,offset:"-8, -12"})})},clearTicks:function(){this.tickNum=this.leftside=0;e(k).css("left",0).html("<div class='timeglider-handle'></div>")},castTicks:function(){this.clearTicks();c.getZoomLevel();var o=c.getFocusDate(),m=c.getZoomInfo().width;m=Math.ceil(this.dimensions.container.width/m)+4;var n="l";c.setTicksReady(false);this.addTick({type:"init",focus_date:o});for(o=1;o<=m;o+=1){this.addTick({type:n});n=n=="l"?"r":"l"}c.setTicksReady(true)},addTick:function(p){var n=0,y=0,w=y=0,x=0,r=0,o="";r={};w={};var A={},m={};r={};A=c.getZoomInfo().unit;m=c.getZoomInfo().width;x=c.getFocusDate();w=parseInt(this.dimensions.tick.top);x=c.addToTicksArray({type:p.type,unit:A},x);var q="",u=0;o="";if(A=="mo"){r=d.getMonthAdj(x,m);m=r.width;n=r.days}this.tickNum++;if(p.type=="init"){r=this.tickOffsetFromDate(c.getZoomInfo(),c.getFocusDate(),m);this.leftside=y=Math.ceil(this.dimensions.container.centerx+r);this.rightside=y+m}else{if(p.type=="l"){this.leftside=y=Math.floor(this.leftside-m)}else{if(p.type=="r"){y=Math.floor(this.rightside);this.rightside+=m}}}c.getTickBySerial(x).width=m;c.getTickBySerial(x).left=y;o=this._views.PLACE+"_"+A+"_"+x+"-"+this.tickNum;r=e("<div class='timeglider-tick' id='"+o+"'><div class='timeglider-tick-label' id='label'></div></div>").appendTo(k);r.css({width:m,left:y,top:w});w=this.getTickMarksInfo({unit:A,width:m});w=n||w.tperu;y=m/w;if(y>5){p=Raphael(o,m,30);var v="";for(n=0;n<w;++n){o=n*y;v+="M"+o+" 20 L"+o+" 30";if(A=="da"&&y>16){o=this.getHourLabelFromHour(u,y);q+="<div class='timeglider-tick-hour-label' style='width:"+(y-4)+"px'>"+o+"</div>";u++}}p.path(v).attr({stroke:"#333","stroke-width":1})}A=="da"&&y>32&&r.append("<div style='position:absolute;top:14px;left:0'>"+q+"</div>");A={unit:A,width:m,serial:x};m=this.getDateLabelForTick(A);r.children("#label").text(m);return A},getHourLabelFromHour:function(o,m){var n="";n=n="";n=o>12?o-12:o;if(n==0){n=12}return n+(m>60?":00":"")+(o>11?" pm":" am")},getTickMarksInfo:function(m){switch(m.unit){case"da":m=24;break;case"mo":m=30;break;case"ye":m=12;break;default:m=10}return{tperu:m}},getDateLabelForTick:function(o){var m=o.serial,n=o.width;switch(o.unit){case"bill":return m==0?"1":m>0?m+" billion":m+" b.y. bce";case"hundredmill":return m==0?"1":m>0?m+"00 million":m+"00 m.y. bce";case"tenmill":return m==0?"1":m>0?m+"0 million":m+"0 m.y. bce";case"mill":return m==0?"1":m>0?m+" million":m+" m.y. bce";case"hundredthou":return m==0?"1":m>0?m+"00,000":m+"00,000 bce";case"tenthou":return m==0?"1":m>0?m+"0,000":m+"0,000 bce";case"thou":return m==0?"1("+m+")":m>0?m+"000":m+"000 bce";case"ce":return m==0?"1("+m+")":m>0?m+"00":m+"00 bce";case"de":return(m-1)*10+"s";case"ye":return m;case"mo":o=d.getDateFromMonthNum(m);return n<120?d.monthNamesAbbr[o.mo]+" "+o.ye:d.monthNames[o.mo]+", "+o.ye;case"da":o=new d(d.getDateFromRD(m));return n<120?d.monthNamesAbbr[o.mo]+" "+o.da+", "+o.ye:d.monthNames[o.mo]+" "+o.da+", "+o.ye;default:return o.unit+":"+m+":"+n}},tickHangies:function(){var n=e(k).position().left,m=this.rightside+n-this.dimensions.container.width;if(this.leftside+n>-100){n=this.addTick({type:"l"});this.appendTimelines(n)}else{if(m<100){n=this.addTick({type:"r"});this.appendTimelines(n)}}},tickOffsetFromDate:function(o,m,n){switch(o.unit){case"da":m=m.ho/24+m.mi/1440;n*=m;break;case"mo":o=d.getMonthDays(m.mo,m.ye);m=(m.da-1)/o+m.ho/(24*o)+m.mi/(1440*o);n*=m;break;case"ye":m=((m.mo-1)*30+m.da)/365;n*=m;break;case"de":m=m.ye%10/10+m.mo/120;n*=m;break;case"ce":m=m.ye%100/100+m.mo/1200;n*=m;break;case"thou":m=m.ye%1000/1000;n*=m;break;case"tenthou":m=m.ye%10000/10000;n*=m;break;case"hundredthou":m=m.ye%100000/100000;n*=m;break;default:n=0}return -1*n},resetTicksHandle:function(){e(this._views.HANDLE).offset({left:e(i).offset().left})},easeOutTicks:function(){Math.abs(this.dragSpeed)>5&&debug.trace("ticks stopped!","note")},getTimelineEventsByTick:function(o){var m=o.tick.unit,n=o.tick.serial;o=o.timeline.dateHash;return o[m][n]&&o[m][n].length>0?o[m][n]:0},setTimelineProp:function(o,m,n){c.timelinePool[o][m]=n},getTimelineProp:function(n,m){return c.timelinePool[n][m]},passesFilters:function(p,m){var o=true,n="",q=[],r;n="";q=[];if(m<p.low_threshold||m>p.high_threshold){return false}if(n=c.filters.include){q=n.split(",");o=false;for(r=0;r<q.length;r++){n=RegExp(e.trim(q[r]),"i");if(p.title.match(n)){o=true}}}if(n=c.filters.exclude){q=n.split(",");for(r=0;r<q.length;r++){n=RegExp(e.trim(q[r]),"i");if(p.title.match(n)){o=false}}}n=p.icon;if(c.filters.legend.length>0){if(e.inArray(n,c.filters.legend)==-1){o=false}}return o},freshTimelines:function(){var M,K,C,w,y=c.activeTimelines,p=c.ticksArray,o="",P,n=this;K="";var N=n.dimensions.container.centerx,q=n.dimensions.container.width,r=c.getFocusDate().sec,x=c.getZoomInfo().spp;c.getZoomInfo();K=[];var I=[];q=r-Math.floor(x*(q/2));K="";for(var B,H=0,E=n.dimensions.container.height,L=H=0;L<y.length;L++){M=c.timelinePool[y[L]];B=M.display;H=M.top?parseInt(M.top.replace("px","")):E-120;K=M.legend.length>0?"<span class='tg-timeline-legend-bt'>legend</span>":"";$tl=e("<div class='tg-timeline-envelope' id='"+M.id+"'><div class='titleBar'><div class='timeline-title'>"+M.title+"<div class='tg-timeline-env-buttons'><span class='timeline-info'>info</span>"+K+"</div></div></div></div>").appendTo(k);$tl.draggable({axis:"y",handle:".titleBar",stop:function(){n.setTimelineProp(M.id,"top",e(this).css("top"));c.refresh()}}).css("top",H);K=$tl.height();e(i+" .tg-timeline-envelope#"+M.id+" .titleBar .expand-collapse").click(function(){n.expandCollapseTimeline(M.id)});e(i+" .tg-timeline-envelope#"+M.id+" .titleBar .timeline-info").click(function(){n.timelineModal(M.id)});e(i+" .tg-timeline-envelope#"+M.id+" .titleBar .tg-timeline-legend-bt").click(function(){n.legendModal(M.id)});P=$tl.children(".titleBar");C=N+(M.bounds.first-r)/x;w=N+(M.bounds.last-r)/x;P.css({top:K,left:C,width:w-C});if(B=="expanded"){M.borg=o=new timeglider.TG_Org}for(C=0;C<p.length;C++){K=this.getTimelineEventsByTick({tick:p[C],timeline:M});e.merge(I,K)}for(C=0;C<M.spans.length;C++){K=M.spans[C];K.start<q&&K.end>q&&e.inArray(K.id,I)==-1&&I.unshift(K.id)}K=this.compileTickEventsAsHtml(M,I,0,"sweep");H=M.hasImagesAbove?H-56:H;if(B=="expanded"){K=o.getHTML("sweep",H);M.borg=o.getBorg()}K!="undefined"&&$tl.append(K);this.registerEventImages($tl)}n.registerTitles()},appendTimelines:function(p){for(var m=c.activeTimelines,o,n="",q=0;q<m.length;q++){o=c.timelinePool[m[q]];idArr=this.getTimelineEventsByTick({tick:p,timeline:o});n=this.compileTickEventsAsHtml(o,idArr,p.serial,"append");if(o.display=="expanded"){n=o.borg.getHTML(p.serial,o.top)}o=e(".tg-timeline-envelope#"+o.id).append(n);this.registerEventImages(o)}},compileTickEventsAsHtml:function(r,m,q,p){var u;u=0;var v=this.dimensions.container.centerx,o=r.display,n=$tl.height();stuff="";foSec=c.startSec;spp=c.getZoomInfo().spp;zl=c.getZoomInfo().level;buffer=20;borg=r.borg;block_arg="sweep";if(p=="append"){block_arg=q}for(q=0;q<m.length;q++){ev=c.eventPool["ev_"+m[q]];if(this.passesFilters(ev,zl)===true){u=v+(ev.startdateObj.sec-foSec)/spp;if(o=="expanded"){impq=r.size_importance!==false?this.scaleToImportance(ev.importance,zl):1;ev.width=ev.titleWidth*impq+buffer;ev.fontsize=this.basicFontSize*impq;ev.left=u;ev.spanwidth=0;if(ev.span==true){ev.spanwidth=(ev.enddateObj.sec-ev.startdateObj.sec)/spp;if(ev.spanwidth>ev.width){ev.width=ev.spanwidth}}u=0;if(ev.image&&ev.image.display_class==="layout"){u=ev.image.height+2;ev.width=ev.image.width>ev.width?ev.image.width:ev.width}ev.height=Math.ceil(ev.fontsize)+u;ev.top=n-ev.height;borg.addBlock(ev,block_arg)}else{if(o=="collapsed"){stuff+="<div id='ev_"+ev.id+"' class='timeglider-event-collapsed' style='top:"+(n-2)+"px;left:"+u+"px'></div>"}}}}return o=="collapsed"?stuff:""},registerEventImages:function(m){e(".timeglider-event-image-bar").each(function(){e(this).position({my:"top",at:"bottom",of:m,offset:"0, 0"}).css("left",0)});e(".timeglider-event-image-above").each(function(){e(this).position({my:"top",at:"top",of:e(i),offset:"0, 12"}).css("left",0)})},expandCollapseTimeline:function(m){m=c.timelinePool[m];m.display=m.display=="expanded"?"collapsed":"expanded";c.refresh()},timelineModal:function(n){e("#tl_"+n+"_modal").remove();var m=c.timelinePool[n];e.tmpl(this._templates.timeline_modal,{title:m.title,description:m.description,id:n}).appendTo(i).css("z-index",this.ztop++).position({my:"left top",at:"left top",of:this._views.CONTAINER,offset:"32, 32",collision:"fit fit"}).draggable({stack:".timeglider-modal"})},createEventLinksMenu:function(p,m){if(!p){return""}var o="",n=0,q="",r="";if(m=="full"){o+="<li><h4>links</h4></li>"}if(typeof p=="string"){o="<li><a href='"+p+"' target='_blank'>link</a></li>"}else{if(typeof p=="object"){for(n=0;n<p.length;n++){q=p[n].url;r=p[n].label;o+="<li><a href='"+q+"' target='_blank'>"+r+"</a></li>"}}}return o},eventModal:function(p){e("#ev_"+p+"_modal").remove();var m=this,o=f.event_modal.type,n=e("#"+p),q=m._templates.event_modal;ev=c.eventPool[p];ev_img=ev.image&&ev.image.src?"<img src='"+ev.image.src+"'>":"";ev_img_src=ev.image&&ev.image.src?ev.image.src:"";links=this.createEventLinksMenu(ev.link,o);ev_descr=o=="default"?ev_img+ev.description:ev.description;templ_obj={title:ev.title,description:ev_descr,id:p,startdate:ev.startdateObj.format("D",true),links:links,image:ev_img_src,video:ev.video};if(ev.video){q=m._templates.event_modal_video;templ_obj.video=ev.video}p=e.tmpl(q,templ_obj);switch(o){case"full":p.appendTo(i).css({"z-index":m.ztop++}).position({my:"left top",at:"left top",of:i,offset:"0, 0",collision:"none none"});p.children(".full_modal_panel").css({width:m.dimensions.container.width-64+"px",height:m.dimensions.container.height-64+"px"});break;default:p.appendTo(k).css("z-index",m.ztop++).position({my:"right center",at:"left center",of:n,offset:"-12, -1",collision:"flip fit"}).draggable().hover(function(){e(this).css("z-index",m.ztop++)})}},legendModal:function(p){var m=c.timelinePool[p].legend,o,n,q,r="";for(o=0;o<m.length;o++){n=f.icon_folder+m[o].icon;q=m[o].title;r+="<li><img src='"+n+"'>"+q+"</li>"}p={id:p,legend_list:r};e(i+" .timeglider-legend").remove();e.tmpl(this._templates.legend_modal,p).appendTo(i).css("z-index",this.ztop++).toggleClass("timeglider-menu-hidden").position({my:"left top",at:"left top",of:i,offset:"16, -4",collision:"none none"});e(i+" .timeglider-legend li").click(function(){e(this).parent().attr("id");var s=e(this).children("img").attr("src");e(this).toggleClass("tg-legend-icon-selected");c.setFilters({origin:"legend",icon:s})})},parseHTMLTable:function(p){var m={},o=+new Date,n=[];e("#"+p).find("tr").each(function(r){var s=e(this).children(),q;if(r===0){n=s.map(function(){return e(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,"$1")}).get()}else{q={};s.each(function(u){q[n[u]]=e(this).text()});m["prefix"+o++]=q}});return m}};j.zoomTree=[{},{unit:"da",width:35000,level:1,label:"5 hours"},{unit:"da",width:17600,level:2,label:"7 hours"},{unit:"da",width:8800,level:3,label:"10 hours"},{unit:"da",width:4400,level:4,label:"12 hours"},{unit:"da",width:2200,level:5,label:"14 hours"},{unit:"da",width:1100,level:6,label:"17 hours"},{unit:"da",width:550,level:7,label:"22 hours"},{unit:"da",width:432,level:8,label:"1 DAY"},{unit:"da",width:343,level:9,label:"1.5 days"},{unit:"da",width:272,level:10,label:"2 days"},{unit:"da",width:216,level:11,label:"2.5 days"},{unit:"da",width:171,level:12,label:"3 days"},{unit:"da",width:136,level:13,label:"3.5 days"},{unit:"da",width:108,level:14,label:"4 days"},{unit:"mo",width:2509,level:15,label:"6 days"},{unit:"mo",width:1945,level:16,label:"1 WEEK"},{unit:"mo",width:1508,level:17,label:"10 days"},{unit:"mo",width:1169,level:18,label:"2 weeks"},{unit:"mo",width:913,level:19,label:"2.5 weeks"},{unit:"mo",width:719,level:20,label:"3 weeks"},{unit:"mo",width:566,level:21,label:"3.5 weeks"},{unit:"mo",width:453,level:22,label:"1 MONTH"},{unit:"mo",width:362,level:23,label:"5.5 weeks"},{unit:"mo",width:290,level:24,label:"7 weeks"},{unit:"mo",width:232,level:25,label:"2 months"},{unit:"mo",width:186,level:26,label:"2.5 months"},{unit:"mo",width:148,level:27,label:"3 months"},{unit:"mo",width:119,level:28,label:"4 months"},{unit:"mo",width:95,level:29,label:"5 months"},{unit:"mo",width:76,level:30,label:"6 months"},{unit:"ye",width:723,level:31,label:"9 months"},{unit:"ye",width:573,level:32,label:"1 YEAR"},{unit:"ye",width:455,level:33,label:"1.25 years"},{unit:"ye",width:361,level:34,label:"1.5 years"},{unit:"ye",width:286,level:35,label:"2 years"},{unit:"ye",width:227,level:36,label:"2.5 years"},{unit:"ye",width:179,level:37,label:"3 years"},{unit:"ye",width:142,level:38,label:"4 years"},{unit:"ye",width:113,level:39,label:"5 years"},{unit:"ye",width:89,level:40,label:"6 years"},{unit:"de",width:705,level:41,label:"8 years"},{unit:"de",width:559,level:42,label:"10 years"},{unit:"de",width:443,level:43,label:"13 years"},{unit:"de",width:302,level:44,label:"16 years"},{unit:"de",width:240,level:45,label:"20 years"},{unit:"de",width:190,level:46,label:"25 years"},{unit:"de",width:150,level:47,label:"30 years"},{unit:"de",width:120,level:48,label:"40 years"},{unit:"de",width:95,level:49,label:"50 years"},{unit:"de",width:76,level:50,label:"65 years"},{unit:"ce",width:600,level:51,label:"80 years"},{unit:"ce",width:480,level:52,label:"100 years"},{unit:"ce",width:381,level:53,label:"130 years"},{unit:"ce",width:302,level:54,label:"160 years"},{unit:"ce",width:240,level:55,label:"200 years"},{unit:"ce",width:190,level:56,label:"250 years"},{unit:"ce",width:150,level:57,label:"300 years"},{unit:"ce",width:120,level:58,label:"400 years"},{unit:"ce",width:95,level:59,label:"500 years"},{unit:"ce",width:76,level:60,label:"600 years"},{unit:"thou",width:603,level:61,label:"1000 years"},{unit:"thou",width:478,level:62,label:"1200 years"},{unit:"thou",width:379,level:63,label:"1800 years"},{unit:"thou",width:301,level:64,label:"160 years"},{unit:"thou",width:239,level:65,label:"xxx years"},{unit:"thou",width:190,level:66,label:"xxx years"},{unit:"thou",width:150,level:67,label:"xxx years"},{unit:"thou",width:120,level:68,label:"xxx years"},{unit:"thou",width:95,level:69,label:"8,000 years"},{unit:"thou",width:76,level:70,label:"10,000 years"},{unit:"tenthou",width:603,level:71,label:"15,000 years"},{unit:"tenthou",width:358,level:72,label:"20,000 years"},{unit:"tenthou",width:213,level:73,label:"30,000 years"},{unit:"tenthou",width:126,level:74,label:"60,000 years"},{unit:"tenthou",width:76,level:75,label:"100,000 years"},{unit:"hundredthou",width:603,level:76,label:"180,000 years"},{unit:"hundredthou",width:358,level:77,label:"300,000 years"},{unit:"hundredthou",width:213,level:78,label:"500,000 years"},{unit:"hundredthou",width:126,level:79,label:"800,000 years"},{unit:"hundredthou",width:76,level:80,label:"1 million years"},{unit:"mill",width:603,level:81,label:"1.2 million years"},{unit:"mill",width:358,level:82,label:"2 million years"},{unit:"mill",width:213,level:83,label:"3 million years"},{unit:"mill",width:126,level:84,label:"5 million years"},{unit:"mill",width:76,level:85,label:"10 million years"},{unit:"tenmill",width:603,level:86,label:"15 million years"},{unit:"tenmill",width:358,level:87,label:"30 million years"},{unit:"tenmill",width:213,level:88,label:"50 million years"},{unit:"tenmill",width:126,level:89,label:"80 million years"},{unit:"tenmill",width:76,level:90,label:"100 million years"},{unit:"hundredmill",width:603,level:91,label:"120 million years"},{unit:"hundredmill",width:358,level:92,label:"200 million years"},{unit:"hundredmill",width:213,level:93,label:"300 million years"},{unit:"hundredmill",width:126,level:94,label:"500 million years"},{unit:"hundredmill",width:76,level:95,label:"1 billion years"},{unit:"bill",width:603,level:96,label:"15 million years"},{unit:"bill",width:358,level:97,label:"30 million years"},{unit:"bill",width:213,level:98,label:"50 million years"},{unit:"bill",width:126,level:99,label:"80 million years"},{unit:"bill",width:76,level:100,label:"100 billion years"}];j.calculateSecPerPx=function(p){for(var m=1;m<p.length;m++){var o=p[m],n=0;switch(o.unit){case"da":n=86400;break;case"mo":n=2419200;break;case"ye":n=31536000;break;case"de":n=315360000;break;case"ce":n=3153600000;break;case"thou":n=31536000000;break;case"tenthou":n=315360000000;break;case"hundredthou":n=3153600000000;break;case"mill":n=31536000000000;break;case"tenmill":n=315360000000000;break;case"hundredmill":n=3153600000000000;break;case"bill":n=31536000000000000}o.spp=n/parseInt(o.width)}}(j.zoomTree);j.getStringWidth=function(m){if(m){return e("#timeglider-measure-span").html(m).width()}};String.prototype.removeWhitespace=function(){return this.replace(RegExp("\\n","g"),"")}})(timeglider);(function(c){var e={},g=c.TG_Date,f={},d=jQuery;c.TimelineCollection=Backbone.Collection.extend({model:timeglider.TG_Timeline});c.TG_Mediator=function(h){this.options=f=h;this._focusDate={};this._zoomInfo={};this._zoomLevel=1;this.ticksReady=false;this.ticksArray=[];this.startSec=0;this.activeTimelines=[];this.max_zoom=f.max_zoom;this.min_zoom=f.min_zoom;this.fixed_zoom=this.max_zoom==this.min_zoom?true:false;this.gesturing=false;this.gestureStartScale=this.gestureStartZoom=0;this.filters={include:"",exclude:"",legend:[]};this.eventPool=[];this.timelinePool={};this.imagesToSize=this.imagesSized=0;this.timelineDataLoaded=false;this.foo="bark";this.initial_timeline_id=f.initial_timeline_id||"";this.sole_timeline_id="";if(f.max_zoom===f.min_zoom){this.fixed_zoom=f.min_zoom}e=this};c.TG_Mediator.prototype={gotoDateZoom:function(j,h){var i=false;this.setFocusDate(new g(j));if(h){i=this.setZoomLevel(h)}if(!h||i==false){this.refresh()}},zoom:function(h){this.setZoomLevel(this.getZoomLevel()+parseInt(h))},loadTimelineData:function(i){var h=this;if(i){if(typeof i==="object"){h.parseData(i)}else{if(i.substr(0,1)=="#"){i=[h.getTableTimelineData(i)];h.parseData(i)}else{d.getJSON(i,function(j){h.parseData(j)})}}}else{this.timelineDataLoaded=true;this.setZoomLevel(Math.floor((this.max_zoom+this.min_zoom)/2));this.tryLoading()}},getTableTimelineData:function(r){var p={},q=0,i=[],l,o,j="",m=d(r);p.id=r.substr(1);p.title=m.attr("title")||"untitled";p.description=m.attr("description")||"";p.focus_date=m.attr("focus_date")||g.getToday;p.initial_zoom=m.attr("initial_zoom")||20;p.events=[];m.find("tr").each(function(h){var k=d(this).children(),n;if(h===0){i=k.map(function(){return d(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,"$1")}).get()}else{n={};k.each(function(s){l=i[s];o=d(this).text();n[l]=o});j="ev_"+q++;n.id=j;p.events.push(n)}});m.css("display","none");return p},parseData:function(l){var j=0,k=l.length,h={};h={};for(var i=0;i<k;i++){h=l[i];h.mediator=this;h=(new timeglider.TG_Timeline(h)).toJSON();if(h.id.length>0){j++;this.swallowTimeline(h)}}if(j===0){alert("ERROR loading data: Check JSON with jsonLint")}else{this.timelineDataLoaded=true;this.tryLoading()}},tryLoading:function(){var h=this.timelineDataLoaded==true;if(this.imagesSized==this.imagesToSize&&h){this.setInitialTimelines();d.publish("mediator.timelineDataLoaded")}},swallowTimeline:function(h){this.sole_timeline_id=h.id;this.timelinePool[h.id]=h;d.publish("mediator.timelineListChangeSignal")},setInitialTimelines:function(){var h=this.initial_timeline_id||this.sole_timeline_id;h&&setTimeout(function(){e.toggleTimeline(h)},1000)},refresh:function(){this.startSec=this._focusDate.sec;d.publish("mediator.refreshSignal")},setTicksReady:function(h){this.ticksReady=h;h===true&&d.publish("mediator.ticksReadySignal")},getFocusDate:function(){return this._focusDate},setFocusDate:function(h){if(h!=this._focusDate){this._focusDate=h}},getZoomLevel:function(){return parseInt(this._zoomLevel)},setZoomLevel:function(h){if(h<=this.max_zoom&&h>=this.min_zoom){this.startSec=this._focusDate.sec;if(h!=this._zoomLevel){this._zoomLevel=h;this._zoomInfo=timeglider.zoomTree[h];d.publish("mediator.zoomLevelChange");return true}else{return false}}else{return false}},getZoomInfo:function(){return this._zoomInfo},setFilters:function(i){switch(i.origin){case"clude":this.filters.include=i.include;this.filters.exclude=i.exclude;break;case"legend":var h=i.icon;if(h=="all"){this.filters.legend=[];d.publish("mediator.legendAll")}else{if(d.inArray(h,this.filters.legend)==-1){this.filters.legend.push(h)}else{i=[];i=d.grep(this.filters.legend,function(j){return j!=h});this.filters.legend=i}}}d.publish("mediator.filtersChange");this.refresh()},getTicksOffset:function(){return this._ticksOffset},setTicksOffset:function(h){this._ticksOffset=h;d.publish("mediator.ticksOffsetChange")},getTickBySerial:function(l){for(var j=this.ticksArray,k=j.length,h=0;h<k;h++){var i=j[h];if(i.serial==l){return i}}return false},addToTicksArray:function(i,h){if(i.type=="init"){i.serial=g.getTimeUnitSerial(h,i.unit);this.ticksArray=[i]}else{if(i.type=="l"){i.serial=this.ticksArray[0].serial-1;this.ticksArray.unshift(i)}else{i.serial=this.ticksArray[this.ticksArray.length-1].serial+1;this.ticksArray.push(i)}}d.publish("mediator.ticksArrayChange");return i.serial},toggleTimeline:function(j){var h=this.timelinePool[j],i=d.inArray(j,this.activeTimelines);if(i==-1){this.activeTimelines.push(j);this.setFocusDate(new g(h.focus_date));this.setZoomLevel(h.initial_zoom)}else{this.activeTimelines.splice(i,1)}this.refresh();d.publish("mediator.activeTimelinesChange")},reportImageSize:function(i){var h=e.eventPool["ev_"+i.id];if(i.error){h.image={};debug.log("WHOOPS: MISSING IMAGE: "+i.src)}else{h.image.width=i.width;h.image.height=i.height}this.imagesSized++;this.imagesSized==this.imagesToSize&&this.tryLoading()}};c.getLowHigh=function(l){var j,k,h=parseFloat(l[0]),i=h;for(j=0;j<l.length;j++){k=parseFloat(l[j]);if(k<i){i=k}if(k>h){h=k}}return{high:h,low:i}};c.validateOptions=function(j){this.optionsMaster={initial_focus:{type:"date"},editor:{type:"string"},backgroundColor:{type:"color"},backgroundImage:{type:"color"},min_zoom:{type:"number",min:1,max:100},max_zoom:{type:"number",min:1,max:100},initial_zoom:{type:"number",min:1,max:100},show_centerline:{type:"boolean"},display_zoom_level:{type:"boolean"},data_source:{type:"url"},basic_fontsize:{type:"number",min:9,max:100},mouse_wheel:{type:"string",possible:["zoom","pan"]},initial_timeline_id:{type:"string"},icon_folder:{type:"string"},show_footer:{type:"boolean"},display_zoom_level:{type:"boolean"},event_modal:{type:"object"}};var h=this,i="";d.each(j,function(k,l){if(h.optionsMaster[k]){switch(h.optionsMaster[k].type){case"string":if(typeof l!="string"){i+=k+" needs to be a string.\n"}if(h.optionsMaster[k].possible){if(d.inArray(l,h.optionsMaster[k].possible)==-1){i+=k+" must be: "+h.optionsMaster[k].possible.join(" or ")}}break;case"number":if(typeof l!="number"){i+=l+" needs to be a number.\n"}if(h.optionsMaster[k].min){if(l<h.optionsMaster[k].min){i+=k+" must be greater than or equal to "+h.optionsMaster[k].min+"\n"}}if(h.optionsMaster[k].max){if(l>h.optionsMaster[k].max){i+=k+" must be less than or equal to "+h.optionsMaster[k].max+"\n"}}break;case"boolean":if(typeof l!="boolean"){i+=l+" needs to be a number.\n"}}}});return i}})(timeglider);(function(c){var e,g,f=timeglider,d=timeglider.TG_Date;c.widget("timeglider.timeline",{options:{initial_focus:f.TG_Date.getToday(),editor:"none",min_zoom:1,max_zoom:100,show_centerline:true,data_source:"",culture:"en",basic_fontsize:12,mouse_wheel:"zoom",initial_timeline_id:"",icon_folder:"js/timeglider/icons/",show_footer:true,display_zoom_level:true,event_modal:{href:"",type:"default"}},_create:function(){this._id=c(this.element).attr("id");this.element.html("<div class='timeglider-container'><div class='timeglider-loading'>loading</div><div class='timeglider-centerline'></div><div class='timeglider-truck' id='tg-truck'><div class='timeglider-ticks'><div class='timeglider-handle'></div></div></div><div class='timeglider-slider-container'><div class='timeglider-slider'></div><div class='timeglider-pan-buttons'><div class='timeglider-pan-left'></div><div class='timeglider-pan-right'></div></div></div><div class='timeglider-footer'><div class='timeglider-logo'></div><div class='timeglider-footer-button timeglider-filter-bt'></div><div class='timeglider-footer-button timeglider-list-bt'></div></div><div class='timeglider-event-hover-info'></div></div><span id='timeglider-measure-span'></span>")},_init:function(){var h=timeglider.validateOptions(this.options);if(h==""){f.TG_Date.setCulture(this.options.culture);g=new f.TG_Mediator(this.options);e=new f.TG_TimelineView(this,g);g.setFocusDate(new d(this.options.initial_focus));g.loadTimelineData(this.options.data_source)}else{alert("Rats. There's a problem with your widget settings:"+h)}},goTo:function(i,h){g.gotoDateZoom(i,h)},zoom:function(h){switch(h){case"in":h=-1;break;case"out":h=1}if(h>99||h<-99){return false}g.zoom(h)},panButton:function(j,h){var i=0;switch(h){case"left":i=30;break;case"right":i=-30;break;default:i=h}e.setPanButton(j,i)},destroy:function(){c.Widget.prototype.destroy.apply(this,arguments);c(this.element).html("")}})})(jQuery);PrimeFaces.widget.Timeline=function(c){this.cfg=c;this.id=this.cfg.id;this.jqId=PrimeFaces.escapeClientId(this.id);this.jq=$(this.jqId);this.cfg=c;this.cfg.show_footer=false;this.cfg.icon_folder="";this.jq.timeline(this.cfg);this.postConstruct()};PrimeFaces.extend(PrimeFaces.widget.Timeline,PrimeFaces.widget.BaseWidget);